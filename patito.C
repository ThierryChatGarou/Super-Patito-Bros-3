
///////////////////////////////////////////
//     Thierry Garcia Greiner            //
//     Super Patito Bros en C            //
///////////////////////////////////////////

//Version 04/03/2021: Fixed compatibility of Windows and MSDOS

#include "patito.h"
#include<stdio.h>
#include<stdlib.h>
#ifdef MSDOS
#include<conio.h>
#include<dos.h>
#include<graphics.h>  //libreria grafica
#include "svgautil.h"
//El juego se debe de compilar en modelo de memoria HUGE, se modifica en el menu->opciones->compiler->codegeneration.
#ifndef __HUGE__
#error Patito debe compilarse en el modelo de memoria HUGE.
#endif
#else
#include"conio2.h"
#include"dos2.h"
#include"graphics.h"  //libreria grafica
#endif // MSDOS
#include"teclado.h"  //libreria para el teclado con interrupciones
#include"teclas.h"  //Lista de teclas


//extern int botonraton,ratonx,ratony;
extern int segundo_invalido;
extern int npc[10],ntortuga[8],tortugax[8],tortugay[8],npato[8],patox[8],patoy[8],nsalta[4],saltax[4],saltay[4],nseguidor[8],seguidorx[8],seguidory[8],npeligro[4],peligrox[4],peligroy[4];
extern int pato0[16][16];
extern float tortugavy[8];

//variables generales:
int patito;  //presentacion
int x,y,o,p;  //x,y es la posicion del personaje principal. o,p es la posicion x,y anterior del personaje para ser borrado.
int escena=0,nivel=0,mundo=0;  //cada mundo tiene varios niveles. Cada nivel tiene varias escenas.
int vidas=4;
int estado=1;  //cada estado es una forma del personaje. 1 es pato chico, 2 es pato, 3 es pinguino negro, 4 es pinguino rojo.
int tiempo=0;  //tiempo para realizar cada nivel
int volar=22;  //cantidad de vuelo que tiene el personaje (no modificar)
int t_volar=0;  //regula la velocidad de consumo del vuelo (no modificar)
int retraso=20;  //Ajusta el retraso entre cada cuadro para tener una cantidad casi constante en cuadros por segundo.
int monedas=0;
int cajamone=0;  //determina cuantas monedas le quedan a la caja (causante del bug cuando hay varias cajas con 10 monedas)
int invensible=0;  //mide el tiempo en cuadros por segundo que le resta inmune a daños al personaje antes de recibir daño otra vez.
int dirx=1,diry=1;  //indica la direccion a la que intenta dirigirse el pinguino, concuerda con las teclas presionadas, no es lo mismo que vx y vy.
int pasox=1,pasoy=1;  //Estado de la animacion, pasox indica la posicion de los pies, pasoy indica la posicion de las alas.
int sec=0;  //se incrementa cada cuadro, y al llegar al valor de CPS le resta un segundo al tiempo.
int t_huevo;  //indica el tiempo que se permanece dentro de la escena despues de perder.
int t_moneda=-88,tdisparo=0;
int saltar=1;  //indica si el personaje puede saltar de nuevo (cuando se ha soltado la tecla de saltar)
int ciclo=0;  //si ciclo=1, se termina la escena actual
int jugar=0;  //cuando jugar=0 se termina el nivel actual
int seguir=1;  //si seguir=0 el ciclo principal del programa se rompe.
int nadando=0;
int CPS=30;  //cuadros por segundo. Es la velocidad a la que el juego funciona.
int debug=1,control_usuario=1;  //modo debug y permitir que el usuario controle el personaje.
int tiempo_invensible=120;  //120 cuadros (4 segundos si CPS=30) de tiempo que el personaje esta inmune despues de recibir daño.
char c1,c2;  //sistema de colisiones  //c3,c4;
int pantalla=0;  //indica que pantalla se debe de actualizar despues de que la ventana se ha minimizado

//Variables de los personajes: contiene la informacion de su existencia, estado, posicion, velocidad, etc.
//nvariable[] cuando es !=0 indica que existe el personaje, el signo o valor puede indicar un estado especifico.
//variablex[], variabley[] indica la posicion de los personajes.
//variableo[], variablep[] indica la posicion anterior de cada personaje para ser borrada
//variablevx[], variablevy[] indica la velocidad de los personajes.
int nmina[8],minax[8],minay[8],minao[8],minap[8];  //minas
int nchamp[4],champx[4],champy[4],champo[4],champp[4];  //champiñones
int nmonedas[4],monedax[4],moneday[4],monealt[4];  //Son las monedas que saltan al golpear una caja
int ndisparo[4],disparox[4],disparoy[4],disparoo[4],disparop[4];  //Son los disparos que puede hacer el personaje

float vx=0,vy=0;  //velocidad del personaje principal.
float disparovx[4],disparovy[4];

long puntos=0;

struct palettetype paleta;

int paisaje[30][40];  //la escena actualmente en pantalla.
int colorcielo[30][40];  //el color de fondo actualmente en pantalla.
int niv0[30][40],niv1[30][40],niv2[30][40],niv3[30][40];  //las 4 escenas que tiene cada nivel.
int cieloniv0[30][40],cieloniv1[30][40],cieloniv2[30][40],cieloniv3[30][40];  //las 4 escenas de cada nivel con el color de fondo.

//Matrizes graficas: Los valores del 0 al 15 son el color, el valor 22 es transparencia.
int pausa0 [16][16]={
{10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10},
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,11,15,15,15,11,11,11,11,15,11,11,11,15,11,11},
{10,11,15,0 ,0 ,15,11,11,11,15,0 ,11,11,15,0 ,11},
{10,11,15,0 ,11,15,0 ,11,15,0 ,15,11,11,15,0 ,11},
{10,11,15,15,15,11,0 ,11,15,15,15,0 ,11,15,0 ,11},
{10,11,15,0 ,0 ,0 ,11,15,11,0 ,0 ,15,11,15,0 ,11},
{10,11,15,0 ,11,11,11,15,0 ,11,11,15,0 ,11,15,15},
{10,11,11,0 ,11,11,11,11,0 ,11,11,11,0 ,11,11,0 },
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11},
{10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10}
};

int pausa1 [16][16]={
{10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{15,11,11,15,15,15,11,11,11,15,11,11,11,11,11,10},
{15,0 ,15,11,0 ,0 ,0 ,11,11,15,0 ,11,11,11,11,10},
{15,0 ,15,0 ,11,11,11,11,15,11,15,11,11,11,11,10},
{15,0 ,11,15,15,11,11,11,15,15,15,0 ,11,11,11,10},
{15,0 ,11,11,0 ,15,11,15,11,0 ,0 ,15,11,11,11,10},
{11,0 ,15,15,15,11,0 ,15,0 ,11,11,15,0 ,11,11,10},
{0 ,11,11,0 ,0 ,0 ,11,11,0 ,11,11,11,0 ,11,11,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10},
{10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10}
};

int moneda0 [16][16]={
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,0 ,0 ,0 ,14,14,14,14,14,14,0 ,0 ,0 ,22,22},
{22,0 ,0 ,14,14,14,14,14,14,14,14,14,14,0 ,0 ,22},
{22,0 ,14,14,14,14,15,15,15,6 ,14,14,14,14,0 ,22},
{22,0 ,14,14,14,14,15,14,14,6 ,14,14,14,14,0 ,22},
{0 ,14,14,14,14,14,15,14,14,6 ,14,14,14,14,14,0 },
{0 ,14,14,14,14,14,15,14,14,6 ,14,14,14,14,14,0 },
{0 ,14,14,14,14,14,15,14,14,6 ,14,14,14,14,14,0 },
{0 ,14,14,14,14,14,15,14,14,6 ,14,14,14,14,14,0 },
{0 ,14,14,14,14,14,15,14,14,6 ,14,14,14,14,14,0 },
{0 ,14,14,14,14,14,15,14,14,6 ,14,14,14,14,14,0 },
{22,0 ,14,14,14,14,15,14,14,6 ,14,14,14,14,0 ,22},
{22,0 ,14,14,14,14,15,6 ,6 ,6 ,14,14,14,14,0 ,22},
{22,0 ,0 ,14,14,14,14,14,14,14,14,14,14,0 ,0 ,22},
{22,22,0 ,0 ,0 ,14,14,14,14,14,14,0 ,0 ,0 ,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22}
};

int disparo0[16][16]={
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,13,22,22,22,22,13,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,13,13,13,22,22,22,22,22,22},
{22,22,22,22,22,22,22,13,15,13,22,15,22,22,22,22},
{22,22,13,22,15,22,13,15,15,13,13,22,22,22,22,22},
{22,22,22,13,22,15,13,15,15,15,13,22,22,22,22,22},
{22,22,13,13,13,15,15,15,15,15,13,13,22,22,22,22},
{13,15,15,15,15,15,15,15,15,15,15,13,13,13,13,22},
{22,22,13,13,22,13,13,15,15,15,15,15,15,13,13,22},
{22,22,22,22,13,13,13,15,15,15,13,13,13,13,22,22},
{22,22,22,13,13,13,15,13,15,13,15,13,22,13,22,22},
{22,22,13,13,13,13,13,13,15,13,13,13,13,13,22,22},
{22,13,22,22,22,22,13,13,15,22,13,13,13,22,22,22},
{22,22,22,22,22,22,22,13,15,13,22,22,13,22,22,22},
{22,22,22,22,22,22,22,22,13,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22}
};

int disparo1 [16][16]={
{22,22,22,22,22,22,22,22,13,22,22,22,22,22,22,22},
{22,22,13,22,22,22,22,22,13,22,22,22,22,22,22,22},
{22,22,13,22,22,22,22,13,15,13,22,22,13,13,22,22},
{22,22,22,13,13,13,22,13,13,13,22,13,13,22,13,22},
{22,22,22,22,13,13,22,13,15,13,13,13,13,22,22,22},
{22,13,13,13,13,13,13,13,15,15,15,13,22,22,22,22},
{22,22,13,13,13,13,15,15,15,15,15,15,13,13,22,22},
{22,22,22,13,13,13,15,15,15,15,15,13,22,22,22,22},
{22,13,22,13,13,15,15,15,15,15,15,15,13,15,15,22},
{22,22,15,15,15,15,15,15,15,15,13,15,15,13,22,22},
{22,22,22,13,13,15,15,13,15,15,13,13,13,13,22,22},
{22,22,22,13,13,13,13,13,15,13,13,13,22,22,22,22},
{22,22,13,22,22,22,13,22,15,13,22,13,13,22,22,22},
{22,22,22,22,22,13,13,13,22,13,22,22,22,13,22,22},
{22,22,22,22,22,22,13,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22}
};

int disparo2 [16][16]={
{22,22,22,13,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,13,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,13,15,13,22,15,22,22,22,22,22},
{22,13,22,22,13,22,13,13,13,13,22,22,13,22,22,22},
{22,22,13,22,22,13,13,15,13,13,22,13,22,22,22,22},
{22,22,22,15,13,15,13,15,13,15,13,22,22,22,22,22},
{22,15,22,22,13,13,15,15,15,13,13,13,15,22,22,22},
{22,22,22,13,13,15,15,15,15,15,13,13,13,13,22,22},
{22,13,13,13,15,15,15,15,15,15,15,15,15,22,15,13},
{22,22,22,13,13,15,15,15,15,15,13,13,13,13,22,22},
{22,22,22,22,15,13,15,15,15,15,13,13,22,22,22,22},
{22,22,22,22,13,13,13,15,13,13,15,22,13,22,22,22},
{22,22,13,22,22,15,13,15,13,22,13,22,22,22,22,22},
{22,22,22,22,13,22,13,13,13,22,22,13,22,15,22,22},
{22,22,22,13,22,22,22,13,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22}
};

int disparo3 [16][16]={
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,13,22,22,22,22,22,22,22,22},
{22,22,15,22,22,22,22,15,13,22,22,22,13,22,22,22},
{22,22,22,22,13,22,22,15,13,13,22,13,22,22,22,22},
{22,13,22,22,22,13,13,15,15,13,15,22,22,22,22,22},
{22,22,13,15,13,13,15,15,15,13,13,13,13,22,22,22},
{22,22,22,13,22,15,15,15,15,15,13,13,22,13,22,22},
{22,13,15,15,15,15,15,15,15,15,15,15,15,15,13,22},
{22,22,13,13,15,15,15,15,15,15,13,13,13,13,22,22},
{22,22,22,22,13,13,15,15,15,13,15,13,13,22,22,22},
{22,22,13,22,13,15,15,15,15,13,13,13,22,13,22,22},
{22,22,22,22,13,13,13,15,15,13,22,22,22,22,13,22},
{22,22,22,13,22,13,13,15,13,22,22,15,22,22,22,22},
{22,22,13,22,15,22,13,15,13,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,15,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,13,22,22,22,22,22,22,22,22}
};

int pinguinorojo0 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,15,4 ,14,14,14,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,14,14,14,14,14,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,8 ,4 ,8 ,4 ,15,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,8 ,4 ,4 ,8 ,15,15,22,22,22},
{22,22,22,4 ,4 ,4 ,4 ,8 ,4 ,4 ,8 ,15,15,22,22,22},
{22,22,22,4 ,4 ,4 ,4 ,8 ,4 ,4 ,8 ,15,15,22,22,22},
{22,22,22,4 ,4 ,4 ,8 ,4 ,4 ,8 ,15,15,15,22,22,22},
{22,22,22,4 ,4 ,4 ,8 ,4 ,4 ,8 ,15,15,15,22,22,22},
{22,22,22,4 ,4 ,4 ,4 ,8 ,8 ,15,15,15,22,22,22,22},
{22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,22,22,22,22},
{22,22,4 ,4 ,4 ,4 ,4 ,14,14,15,15,22,22,22,22,22},
{22,22,22,22,22,14,14,14,14,14,14,14,22,22,22,22}
};

int pinguinorojo1 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,15,4 ,14,14,14,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,14,14,14,14,14,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,8 ,8 ,4 ,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,22,22,22},
{22,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,8 ,8 ,22},
{4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,8 },
{22,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,8 ,8 ,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,22,22,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,22,22,22},
{22,22,14,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,14,22,22,22},
{22,22,14,14,4 ,4 ,4 ,4 ,4 ,4 ,8 ,14,14,14,22,22},
{22,22,22,14,14,14,4 ,4 ,4 ,8 ,14,14,14,22,22,22},
{22,22,22,22,14,14,14,4 ,14,14,14,14,22,22,22,22}
};

int pinguinorojo2 [16][16]={
{22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22,22},
{22,22,22,22,22,4 ,15,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,14,14,14,4 ,15,4 ,4 ,4 ,22,22,22,22,22},
{22,22,14,14,14,14,14,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,15,4 ,8 ,4 ,8 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,15,15,8 ,4 ,4 ,8 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,15,15,8 ,4 ,4 ,8 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,15,15,8 ,4 ,4 ,8 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,15,15,15,8 ,4 ,4 ,8 ,4 ,4 ,4 ,22,22,22},
{22,22,22,15,15,15,8 ,4 ,4 ,8 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,15,15,15,8 ,8 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22},
{22,22,22,22,22,15,15,14,14,4 ,4 ,4 ,4 ,4 ,22,22},
{22,22,22,22,14,14,14,14,14,14,14,22,22,22,22,22}
};

int pinguinorojo3 [16][16]={
{22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22,22},
{22,22,22,22,22,4 ,15,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,14,14,14,4 ,15,4 ,4 ,4 ,22,22,22,22,22},
{22,22,14,14,14,14,14,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,4 ,8 ,8 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,8 ,8 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,22},
{8 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 },
{22,8 ,8 ,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,22},
{22,22,22,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,14,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,14,22,22},
{22,22,14,14,14,8 ,4 ,4 ,4 ,4 ,4 ,4 ,14,14,22,22},
{22,22,22,14,14,14,8 ,4 ,4 ,4 ,14,14,14,22,22,22},
{22,22,22,22,14,14,14,14,4 ,14,14,14,22,22,22,22}
};

int pinguino0 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,15,0 ,14,14,14,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,14,14,14,14,14,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,8 ,0 ,8 ,0 ,15,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,8 ,0 ,0 ,8 ,15,15,22,22,22},
{22,22,22,0 ,0 ,0 ,0 ,8 ,0 ,0 ,8 ,15,15,22,22,22},
{22,22,22,0 ,0 ,0 ,0 ,8 ,0 ,0 ,8 ,15,15,22,22,22},
{22,22,22,0 ,0 ,0 ,8 ,0 ,0 ,8 ,15,15,15,22,22,22},
{22,22,22,0 ,0 ,0 ,8 ,0 ,0 ,8 ,15,15,15,22,22,22},
{22,22,22,0 ,0 ,0 ,0 ,8 ,8 ,15,15,15,22,22,22,22},
{22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,22,22,22,22},
{22,22,0 ,0 ,0 ,0 ,0 ,14,14,15,15,22,22,22,22,22},
{22,22,22,22,22,14,14,14,14,14,14,14,22,22,22,22}
};

int pinguino1 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,15,0 ,14,14,14,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,14,14,14,14,14,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,8 ,8 ,0 ,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,22,22,22},
{22,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,8 ,8 ,22},
{0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,8 },
{22,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,8 ,8 ,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,22,22,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,22,22,22},
{22,22,14,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,14,22,22,22},
{22,22,14,14,0 ,0 ,0 ,0 ,0 ,0 ,8 ,14,14,14,22,22},
{22,22,22,14,14,14,0 ,0 ,0 ,8 ,14,14,14,22,22,22},
{22,22,22,22,14,14,14,0 ,14,14,14,14,22,22,22,22}
};

int pinguino2 [16][16]={
{22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,14,14,14,0 ,15,0 ,0 ,0 ,22,22,22,22,22},
{22,22,14,14,14,14,14,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,15,0 ,8 ,0 ,8 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,15,15,8 ,0 ,0 ,8 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,15,15,8 ,0 ,0 ,8 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,15,15,8 ,0 ,0 ,8 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,15,15,15,8 ,0 ,0 ,8 ,0 ,0 ,0 ,22,22,22},
{22,22,22,15,15,15,8 ,0 ,0 ,8 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,15,15,15,8 ,8 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22},
{22,22,22,22,22,15,15,14,14,0 ,0 ,0 ,0 ,0 ,22,22},
{22,22,22,22,14,14,14,14,14,14,14,22,22,22,22,22}
};

int pinguino3 [16][16]={
{22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,14,14,14,0 ,15,0 ,0 ,0 ,22,22,22,22,22},
{22,22,14,14,14,14,14,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,0 ,8 ,8 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,8 ,8 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,22},
{8 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 },
{22,8 ,8 ,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,22},
{22,22,22,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,14,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,14,22,22},
{22,22,14,14,14,8 ,0 ,0 ,0 ,0 ,0 ,0 ,14,14,22,22},
{22,22,22,14,14,14,8 ,0 ,0 ,0 ,14,14,14,22,22,22},
{22,22,22,22,14,14,14,14,0 ,14,14,14,22,22,22,22}
};

int pinguino_bajando0 [16][16]={
{22,22,22,22,22,14,14,14,22,14,14,14,14,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,0 ,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,0 },
{22,0 ,0 ,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,0 ,0 },
{22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 },
{22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22}
};

int pinguino_bajando1 [16][16]={
{22,22,22,22,14,14,14,14,22,14,14,14,14,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,0 ,0 ,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,0 ,0 },
{22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 },
{22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22}
};

int pinguino_bajando2 [16][16]={
{22,22,22,22,14,14,14,14,22,14,14,14,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22},
{22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22},
{22,0 ,0 ,0 ,22,22,0 ,0 ,0 ,0 ,0 ,22,22,0 ,0 ,0 },
{22,0 ,0 ,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,0 ,0 },
{22,0 ,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,0 },
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22}
};

int pinguino_escalando0 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,15,0 ,14,14,14,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,14,14,14,14,14,8 ,8 },
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,8 ,0 ,8 },
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,8 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,8 ,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,22,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,8 ,15,0 ,0 ,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,0 ,0 ,0 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,22,6 ,0 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,6 ,6 ,14},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,22,22,14},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,15,15,14,14,14},
{22,22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,14,14},
{22,22,22,22,22,22,22,22,22,0 ,0 ,22,22,22,22,14}
};

int pinguino_escalando1 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,15,0 ,14,14,14,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,14,14,14,14,14,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,8 ,8 },
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,8 ,0 ,8 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,8 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,8 ,0 },
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,8 ,15,0 ,0 ,22},
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,22,22,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,22,22,14},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,6 ,6 ,14},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,14,14,14},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,15,15,22,14,14},
{22,22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,14},
{22,22,22,22,22,22,22,22,22,0 ,0 ,22,22,22,22,22}
};

int pinguino_escalando2 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,15,0 ,14,14,14,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,14,14,14,14,14,22,0 },
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,0 ,0 ,0 ,0 },
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,8 ,8 ,8 ,0 ,0 ,0 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,22},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,8 },
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 },
{22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,22,8 ,8 },
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,22,22,14},
{22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,15,22,14,14},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,15,15,14,14,14},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,15,15,6 ,6 ,14},
{22,22,22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,6 ,6 },
{22,22,22,22,22,22,22,22,22,0 ,0 ,22,22,22,22,6 }
};

int pinguino_escalando2_0 [16][16]={
{22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,14,14,14,0 ,15,0 ,0 ,0 ,22,22,22,22,22},
{8 ,8 ,14,14,14,14,14,0 ,0 ,0 ,0 ,22,22,22,22,22},
{8 ,0 ,8 ,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{8 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,8 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,0 ,0 ,15,8 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{0 ,0 ,0 ,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{0 ,6 ,22,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{14,6 ,6 ,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{14,22,22,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{14,14,14,15,15,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{14,14,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22,22},
{14,22,22,22,22,0 ,0 ,22,22,22,22,22,22,22,22,22}
};

int pinguino_escalando2_1 [16][16]={
{22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,14,14,14,0 ,15,0 ,0 ,0 ,22,22,22,22,22},
{22,22,14,14,14,14,14,0 ,0 ,0 ,0 ,22,22,22,22,22},
{8 ,8 ,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{8 ,0 ,8 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{8 ,0 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{0 ,8 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,0 ,0 ,15,8 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{22,22,22,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{14,22,22,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{14,6 ,6 ,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{14,14,14,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{14,14,22,15,15,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{14,22,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,22,22,22,22,22,22,22,22,22}
};

int pinguino_escalando2_2 [16][16]={
{22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,14,14,14,0 ,15,0 ,0 ,0 ,22,22,22,22,22},
{0 ,22,14,14,14,14,14,0 ,0 ,0 ,0 ,22,22,22,22,22},
{0 ,0 ,0 ,0 ,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{0 ,0 ,0 ,8 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{8 ,0 ,0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{0 ,0 ,8 ,8 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{8 ,8 ,22,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22},
{14,22,22,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{14,14,22,15,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{14,14,14,15,15,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{14,6 ,6 ,15,15,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{6 ,6 ,22,22,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22,22,22},
{6 ,22,22,22,22,0 ,0 ,22,22,22,22,22,22,22,22,22}
};

int pinguino_subiendo0 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,15,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,14,14,14,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,14,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,15,15,15,0 ,0 ,0 ,22,22,22},
{22,22,22,0 ,0 ,0 ,15,15,15,15,15,0 ,0 ,0 ,22,22},
{22,22,0 ,0 ,0 ,15,15,15,15,15,15,15,0 ,0 ,0 ,22},
{22,0 ,0 ,0 ,0 ,0 ,15,15,15,15,15,0 ,0 ,0 ,0 ,0 },
{22,0 ,0 ,22,0 ,0 ,15,15,15,15,15,0 ,0 ,22,0 ,0 },
{22,0 ,22,22,22,0 ,15,15,15,15,15,0 ,22,22,22,0 },
{22,22,22,22,22,0 ,0 ,15,15,15,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,15,15,15,0 ,22,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,14,14,14,22,14,14,14,14,22,22,22}
};

int pinguino_subiendo1 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,15,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,14,14,14,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,14,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22},
{22,22,0 ,0 ,0 ,0 ,0 ,15,15,15,0 ,0 ,0 ,0 ,0 ,22},
{22,0 ,0 ,0 ,0 ,0 ,15,15,15,15,15,0 ,0 ,0 ,0 ,0 },
{22,0 ,0 ,22,0 ,15,15,15,15,15,15,15,0 ,22,0 ,0 },
{22,22,22,22,0 ,0 ,15,15,15,15,15,0 ,0 ,22,22,22},
{22,22,22,22,0 ,0 ,15,15,15,15,15,0 ,0 ,22,22,22},
{22,22,22,22,22,0 ,15,15,15,15,15,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,15,15,15,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,15,15,15,0 ,22,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,14,14,14,14,22,14,14,14,14,22,22,22}
};

int pinguino_subiendo2 [16][16]={
{22,22,22,22,22,22,22,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,15,0 ,15,0 ,22,22,22,22,22},
{22,0 ,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,0 },
{22,0 ,0 ,22,22,0 ,0 ,14,14,14,0 ,0 ,22,22,0 ,0 },
{22,0 ,0 ,0 ,22,22,0 ,0 ,14,0 ,0 ,22,22,0 ,0 ,0 },
{22,22,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,22},
{22,22,22,0 ,0 ,0 ,0 ,15,15,15,0 ,0 ,0 ,0 ,22,22},
{22,22,22,22,0 ,0 ,15,15,15,15,15,0 ,0 ,22,22,22},
{22,22,22,22,0 ,15,15,15,15,15,15,15,0 ,22,22,22},
{22,22,22,22,0 ,0 ,15,15,15,15,15,0 ,0 ,22,22,22},
{22,22,22,22,0 ,0 ,15,15,15,15,15,0 ,0 ,22,22,22},
{22,22,22,22,22,0 ,15,15,15,15,15,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,15,15,15,0 ,0 ,22,22,22,22},
{22,22,22,22,22,22,0 ,15,15,15,0 ,22,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,14,14,14,14,22,14,14,14,22,22,22,22}
};

int pinguinorojo_bajando0 [16][16]={
{22,22,22,22,22,14,14,14,22,14,14,14,14,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,4 ,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,4 },
{22,4 ,4 ,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,4 ,4 },
{22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 },
{22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22}
};

int pinguinorojo_bajando1 [16][16]={
{22,22,22,22,14,14,14,14,22,14,14,14,14,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,4 ,4 ,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,4 ,4 },
{22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 },
{22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22}
};

int pinguinorojo_bajando2 [16][16]={
{22,22,22,22,14,14,14,14,22,14,14,14,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22},
{22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22},
{22,4 ,4 ,4 ,22,22,4 ,4 ,4 ,4 ,4 ,22,22,4 ,4 ,4 },
{22,4 ,4 ,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,4 ,4 },
{22,4 ,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,4 },
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22}
};

int pinguinorojo_escalando0 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,15,4 ,14,14,14,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,14,14,14,14,14,8 ,8 },
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,8 ,4 ,8 },
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,8 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,8 ,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,22,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,8 ,15,4 ,4 ,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,4 ,4 ,4 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,22,6 ,4 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,6 ,6 ,14},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,22,22,14},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,15,15,14,14,14},
{22,22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,14,14},
{22,22,22,22,22,22,22,22,22,4 ,4 ,22,22,22,22,14}
};

int pinguinorojo_escalando1 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,15,4 ,14,14,14,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,14,14,14,14,14,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,8 ,8 },
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,8 ,4 ,8 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,8 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,8 ,4 },
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,8 ,15,4 ,4 ,22},
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,22,22,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,22,22,14},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,6 ,6 ,14},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,14,14,14},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,15,15,22,14,14},
{22,22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,14},
{22,22,22,22,22,22,22,22,22,4 ,4 ,22,22,22,22,22}
};

int pinguinorojo_escalando2 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,15,4 ,14,14,14,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,14,14,14,14,14,22,4 },
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,4 ,4 ,4 ,4 },
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,8 ,8 ,8 ,4 ,4 ,4 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,22},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,8 },
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 },
{22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,15,15,22,8 ,8 },
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,22,22,14},
{22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,15,22,14,14},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,15,15,14,14,14},
{22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,15,15,6 ,6 ,14},
{22,22,22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,6 ,6 },
{22,22,22,22,22,22,22,22,22,4 ,4 ,22,22,22,22,6 }
};

int pinguinorojo_escalando2_0 [16][16]={
{22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22,22},
{22,22,22,22,22,4 ,15,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,14,14,14,4 ,15,4 ,4 ,4 ,22,22,22,22,22},
{8 ,8 ,14,14,14,14,14,4 ,4 ,4 ,4 ,22,22,22,22,22},
{8 ,4 ,8 ,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{8 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,8 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,4 ,4 ,15,8 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{4 ,4 ,4 ,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{4 ,6 ,22,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{14,6 ,6 ,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{14,22,22,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{14,14,14,15,15,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{14,14,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22,22},
{14,22,22,22,22,4 ,4 ,22,22,22,22,22,22,22,22,22}
};

int pinguinorojo_escalando2_1 [16][16]={
{22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22,22},
{22,22,22,22,22,4 ,15,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,14,14,14,4 ,15,4 ,4 ,4 ,22,22,22,22,22},
{22,22,14,14,14,14,14,4 ,4 ,4 ,4 ,22,22,22,22,22},
{8 ,8 ,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{8 ,4 ,8 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{8 ,4 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{4 ,8 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,4 ,4 ,15,8 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{22,22,22,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{14,22,22,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{14,6 ,6 ,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{14,14,14,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{14,14,22,15,15,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{14,22,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,22,22,22,22,22,22,22,22,22}
};

int pinguinorojo_escalando2_2 [16][16]={
{22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22,22},
{22,22,22,22,22,4 ,15,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,14,14,14,4 ,15,4 ,4 ,4 ,22,22,22,22,22},
{4 ,22,14,14,14,14,14,4 ,4 ,4 ,4 ,22,22,22,22,22},
{4 ,4 ,4 ,4 ,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{4 ,4 ,4 ,8 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{22,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{8 ,4 ,4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{4 ,4 ,8 ,8 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{8 ,8 ,22,15,15,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22},
{14,22,22,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{14,14,22,15,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{14,14,14,15,15,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22},
{14,6 ,6 ,15,15,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22},
{6 ,6 ,22,22,4 ,4 ,4 ,4 ,4 ,22,22,22,22,22,22,22},
{6 ,22,22,22,22,4 ,4 ,22,22,22,22,22,22,22,22,22}
};

int pinguinorojo_subiendo0 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,15,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,14,14,14,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,14,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,4 ,4 ,4 ,15,15,15,4 ,4 ,4 ,22,22,22},
{22,22,22,4 ,4 ,4 ,15,15,15,15,15,4 ,4 ,4 ,22,22},
{22,22,4 ,4 ,4 ,15,15,15,15,15,15,15,4 ,4 ,4 ,22},
{22,4 ,4 ,4 ,4 ,4 ,15,15,15,15,15,4 ,4 ,4 ,4 ,4 },
{22,4 ,4 ,22,4 ,4 ,15,15,15,15,15,4 ,4 ,22,4 ,4 },
{22,4 ,22,22,22,4 ,15,15,15,15,15,4 ,22,22,22,4 },
{22,22,22,22,22,4 ,4 ,15,15,15,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,15,15,15,4 ,22,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,22,14,14,14,22,14,14,14,14,22,22,22}
};

int pinguinorojo_subiendo1 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,15,4 ,15,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,14,14,14,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,4 ,14,4 ,4 ,22,22,22,22,22},
{22,22,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,22},
{22,22,4 ,4 ,4 ,4 ,4 ,15,15,15,4 ,4 ,4 ,4 ,4 ,22},
{22,4 ,4 ,4 ,4 ,4 ,15,15,15,15,15,4 ,4 ,4 ,4 ,4 },
{22,4 ,4 ,22,4 ,15,15,15,15,15,15,15,4 ,22,4 ,4 },
{22,22,22,22,4 ,4 ,15,15,15,15,15,4 ,4 ,22,22,22},
{22,22,22,22,4 ,4 ,15,15,15,15,15,4 ,4 ,22,22,22},
{22,22,22,22,22,4 ,15,15,15,15,15,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,15,15,15,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,15,15,15,4 ,22,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,14,14,14,14,22,14,14,14,14,22,22,22}
};

int pinguinorojo_subiendo2 [16][16]={
{22,22,22,22,22,22,22,4 ,4 ,4 ,22,22,22,22,22,22},
{22,22,22,22,22,22,4 ,15,4 ,15,4 ,22,22,22,22,22},
{22,4 ,22,22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22,22,22,4 },
{22,4 ,4 ,22,22,4 ,4 ,14,14,14,4 ,4 ,22,22,4 ,4 },
{22,4 ,4 ,4 ,22,22,4 ,4 ,14,4 ,4 ,22,22,4 ,4 ,4 },
{22,22,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,4 ,22},
{22,22,22,4 ,4 ,4 ,4 ,15,15,15,4 ,4 ,4 ,4 ,22,22},
{22,22,22,22,4 ,4 ,15,15,15,15,15,4 ,4 ,22,22,22},
{22,22,22,22,4 ,15,15,15,15,15,15,15,4 ,22,22,22},
{22,22,22,22,4 ,4 ,15,15,15,15,15,4 ,4 ,22,22,22},
{22,22,22,22,4 ,4 ,15,15,15,15,15,4 ,4 ,22,22,22},
{22,22,22,22,22,4 ,15,15,15,15,15,4 ,22,22,22,22},
{22,22,22,22,22,4 ,4 ,15,15,15,4 ,4 ,22,22,22,22},
{22,22,22,22,22,22,4 ,15,15,15,4 ,22,22,22,22,22},
{22,22,22,22,22,22,14,22,22,22,14,22,22,22,22,22},
{22,22,22,22,14,14,14,14,22,14,14,14,22,22,22,22}
};

int patito0 [16][16]={
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,0 ,14,14,14,14,0 ,22,22,22,22,22},
{22,22,22,22,0 ,14,0 ,14,14,0 ,14,0 ,22,22,22,22},
{22,22,22,0 ,14,14,14,14,14,14,14,14,0 ,22,22,22},
{22,22,22,0 ,14,14,0 ,0 ,0 ,0 ,14,14,0 ,22,22,22},
{22,22,22,22,0 ,14,14,14,14,14,14,0 ,22,22,22,22},
{22,22,22,22,22,0 ,0 ,0 ,0 ,0 ,0 ,22,22,22,22,22},
{22,22,22,22,22,22,0 ,15,15,0 ,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,15,15,15,0 ,22,22,22,22,22},
{22,22,22,22,0 ,0 ,0 ,15,15,0 ,0 ,0 ,22,22,22,22}
};

int huevo [16][16]={
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,22,0 ,0 ,22,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,15,15,0 ,22,22,22,22,22,22},
{22,22,22,22,22,0 ,15,15,0 ,15,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,15,0 ,15,15,0 ,22,22,22,22,22},
{22,22,22,22,0 ,15,0 ,15,15,15,15,0 ,22,22,22,22},
{22,22,22,22,0 ,15,15,0 ,15,15,7 ,0 ,22,22,22,22},
{22,22,22,22,0 ,15,15,15,15,15,7 ,0 ,22,22,22,22},
{22,22,22,22,0 ,15,15,15,15,7 ,7 ,0 ,22,22,22,22},
{22,22,22,22,22,0 ,15,15,15,7 ,0 ,22,22,22,22,22},
{22,22,22,22,22,0 ,15,15,7 ,7 ,0 ,22,22,22,22,22},
{22,22,22,22,22,22,0 ,7 ,7 ,0 ,22,22,22,22,22,22},
{22,22,22,22,22,22,22,0 ,0 ,22,22,22,22,22,22,22}
};

int champi0 [16][16]={
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,0 ,0 ,12,15,15,12,0 ,0 ,22,22,22,22},
{22,22,22,0 ,12,12,12,15,15,12,12,12,0 ,22,22,22},
{22,22,0 ,15,15,15,15,15,15,15,12,12,15,0 ,22,22},
{22,0 ,12,15,15,15,15,12,12,15,15,15,15,12,0 ,22},
{22,0 ,12,12,15,15,12,12,12,12,15,15,12,12,0 ,22},
{0 ,12,12,12,15,15,12,12,12,12,15,15,12,12,12,0 },
{0 ,12,12,15,15,15,15,12,12,15,15,15,15,12,12,0 },
{0 ,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0 },
{0 ,15,15,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,15,15,0 },
{0 ,0 ,0 ,15,15,15,0 ,15,15,0 ,15,15,15,0 ,0 ,0 },
{22,22,0 ,15,15,15,0 ,15,15,0 ,15,15,15,0 ,22,22},
{22,22,0 ,15,15,15,15,15,15,15,15,15,15,0 ,22,22},
{22,22,0 ,15,15,15,15,15,15,15,15,15,15,0 ,22,22},
{22,22,22,0 ,15,15,15,15,15,15,15,15,0 ,22,22,22}
};

int champi4 [16][16]={
{22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22},
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,0 ,0 ,15,10,10,15,0 ,0 ,22,22,22,22},
{22,22,22,0 ,15,15,15,10,10,15,15,15,0 ,22,22,22},
{22,22,0 ,10,10,10,10,10,10,10,15,15,10,0 ,22,22},
{22,0 ,15,10,10,10,10,15,15,10,10,10,10,15,0 ,22},
{22,0 ,15,15,10,10,15,15,15,15,10,10,15,15,0 ,22},
{0 ,15,15,15,10,10,15,15,15,15,10,10,15,15,15,0 },
{0 ,15,15,10,10,10,10,15,15,10,10,10,10,15,15,0 },
{0 ,10,10,10,10,10,10,10,10,10,10,10,10,10,10,0 },
{0 ,10,10,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,10,10,0 },
{0 ,0 ,0 ,10,10,10,0 ,10,10,0 ,10,10,10,0 ,0 ,0 },
{22,22,0 ,10,10,10,0 ,10,10,0 ,10,10,10,0 ,22,22},
{22,22,0 ,10,10,10,10,10,10,10,10,10,10,0 ,22,22},
{22,22,0 ,10,10,10,10,10,10,10,10,10,10,0 ,22,22},
{22,22,22,0 ,10,10,10,10,10,10,10,10,0 ,22,22,22}
};

int calavera0 [16][16]={
{22,22,22,22,22,22,0 ,0 ,0 ,0 ,22,22,22,22,22,22},
{22,22,22,22,0 ,0 ,8 ,7 ,7 ,7 ,0 ,0 ,22,22,22,22},
{22,22,22,22,0 ,8 ,7 ,7 ,7 ,7 ,7 ,0 ,22,22,22,22},
{22,22,22,22,0 ,8 ,7 ,7 ,7 ,7 ,7 ,0 ,22,22,22,22},
{22,22,22,0 ,8 ,7 ,0 ,7 ,7 ,0 ,7 ,7 ,0 ,22,22,22},
{22,22,22,0 ,8 ,0 ,4 ,7 ,7 ,4 ,0 ,7 ,0 ,22,22,22},
{22,22,22,0 ,8 ,7 ,7 ,0 ,0 ,7 ,7 ,7 ,0 ,22,22,22},
{22,22,22,0 ,0 ,0 ,8 ,7 ,0 ,7 ,0 ,0 ,0 ,22,22,22},
{22,22,0 ,0 ,7 ,0 ,8 ,7 ,7 ,7 ,0 ,7 ,0 ,0 ,22,22},
{22,22,0 ,7 ,7 ,7 ,0 ,0 ,0 ,0 ,7 ,7 ,7 ,0 ,22,22},
{22,22,0 ,0 ,0 ,0 ,7 ,0 ,0 ,7 ,0 ,0 ,0 ,0 ,22,22},
{22,22,22,22,0 ,0 ,0 ,7 ,7 ,0 ,0 ,22,22,22,22,22},
{22,22,0 ,0 ,0 ,7 ,7 ,0 ,0 ,7 ,7 ,0 ,0 ,0 ,22,22},
{22,22,0 ,7 ,7 ,0 ,0 ,0 ,0 ,0 ,0 ,7 ,7 ,0 ,22,22},
{22,22,0 ,0 ,7 ,0 ,22,22,22,22,0 ,7 ,0 ,0 ,22,22},
{22,22,22,0 ,0 ,0 ,22,22,22,22,0 ,0 ,0 ,22,22,22}
};

int mina0 [16][16]={
{0 ,0 ,22,22,22,22,22,22,22,22,22,22,22,22,0 ,0 },
{0 ,1 ,0 ,0 ,22,22,0 ,0 ,0 ,0 ,22,22,0 ,0 ,10,0 },
{22,0 ,7 ,8 ,0 ,0 ,8 ,8 ,8 ,8 ,0 ,0 ,8 ,7 ,0 ,22},
{22,0 ,8 ,0 ,8 ,8 ,7 ,7 ,7 ,7 ,8 ,8 ,0 ,8 ,0 ,22},
{22,22,0 ,8 ,8 ,7 ,7 ,15,15,15,7 ,8 ,8 ,0 ,22,22},
{22,22,0 ,8 ,7 ,7 ,7 ,7 ,7 ,15,15,7 ,8 ,0 ,22,22},
{22,0 ,8 ,7 ,7 ,7 ,7 ,7 ,7 ,15,15,15,7 ,8 ,0 ,22},
{22,0 ,8 ,7 ,8 ,7 ,7 ,7 ,7 ,7 ,7 ,15,7 ,8 ,0 ,22},
{22,0 ,8 ,7 ,8 ,7 ,7 ,7 ,7 ,7 ,7 ,15,7 ,8 ,0 ,22},
{22,0 ,8 ,7 ,8 ,8 ,8 ,7 ,7 ,7 ,7 ,7 ,7 ,8 ,0 ,22},
{22,22,0 ,8 ,7 ,8 ,8 ,7 ,7 ,7 ,7 ,7 ,8 ,0 ,22,22},
{22,22,0 ,8 ,8 ,7 ,8 ,8 ,8 ,7 ,7 ,8 ,8 ,0 ,22,22},
{22,0 ,8 ,0 ,8 ,8 ,7 ,7 ,7 ,7 ,8 ,8 ,0 ,8 ,0 ,22},
{22,0 ,7 ,8 ,0 ,0 ,8 ,8 ,8 ,8 ,0 ,0 ,8 ,7 ,0 ,22},
{0 ,12,0 ,0 ,22,22,0 ,0 ,0 ,0 ,22,22,0 ,0 ,14,0 },
{0 ,0 ,22,22,22,22,22,22,22,22,22,22,22,22,0 ,0 }
};


//Nombre de las tarjetas de video
char *dname[] = {"Requiere deteccion",
                 "CGA",
                 "MCGA",
                 "EGA",
                 "EGA 64K",
                 "EGA mono",                      /* EGA monocromo */
                 "IBM 8514",
                 "Hercules mono",                /* Hercules monocromo */
                 "AT&T 6300 PC",
                 "VGA",                        //Unica soportada
                 "IBM 3270 PC"         };


void Patito()
{
textcolor(0x0B);
textbackground(0x00);
clrscr();
gotoxy(20,24); cprintf ("    TTT    T  ");
gotoxy(20,25); cprintf ("    T  T   T  ");
gotoxy(20,26); cprintf ("    TTT   T T ");
gotoxy(20,27); cprintf ("    T     TTT ");
gotoxy(20,28); cprintf ("    T    T   T");

textcolor(0x0F);
gotoxy(34,24); cprintf (" TTTTT ");
gotoxy(34,25); cprintf ("   T   ");
gotoxy(34,26); cprintf ("   T   ");
gotoxy(34,27); cprintf ("   T   ");
gotoxy(34,28); cprintf ("   T   ");

textcolor(0x0B);
gotoxy(41,24); cprintf ("T");
gotoxy(41,25); cprintf ("T");
gotoxy(41,26); cprintf ("T");
gotoxy(41,27); cprintf ("T");
gotoxy(41,28); cprintf ("T");

textcolor(0x0F);
gotoxy(42,24); cprintf (" TTTTT ");
gotoxy(42,25); cprintf ("   T   ");
gotoxy(42,26); cprintf ("   T   ");
gotoxy(42,27); cprintf ("   T   ");
gotoxy(42,28); cprintf ("   T   ");

textcolor(0x0B);
gotoxy(49,24); cprintf (" TT   ");
gotoxy(49,25); cprintf ("T  T  ");
gotoxy(49,26); cprintf ("T  T  ");
gotoxy(49,27); cprintf ("T  T  ");
gotoxy(49,28); cprintf (" TT   ");

gotoxy(1,50);
for (patito=0;patito<22;patito++)
  {
  delay(40);
  if(kbhit())
    {
    patito=40;
    }
  }
for (patito=0;patito<30;patito++)
  {
  printf("\n");
  delay(40);
  if(kbhit())
    {
    patito=40;
    }
  }
}


void Thierry()
{
textbackground(0x00);
clrscr();

textcolor(0x0F); gotoxy(16,24); cprintf (" ÜÜÜÜÜÜÜ  Ü    Ü  Ü  ÜÜÜÜÜ  ÜÜÜÜ   ÜÜÜÜ    Ü     Ü    \n");
textcolor(0x09); gotoxy(16,25); cprintf ("    Û     Û    Û  Û  Û      Û   Û  Û   Û   ßÛ   Ûß    \n");
textcolor(0x0B); gotoxy(16,26); cprintf ("    Û     Û    Û  Û  Û      ÛÜÜÜß  ÛÜÜÜß    ßÛ Ûß     \n");
textcolor(0x0A); gotoxy(16,27); cprintf ("    Û     ÛßßßßÛ  Û  Ûßßßß  ÛÛ     ÛÛ        ßÛß      \n");
textcolor(0x0E); gotoxy(16,28); cprintf ("    Û     Û    Û  Û  Û      Û Û    Û Û       Ûß       \n");
textcolor(0x0C); gotoxy(16,29); cprintf ("    Û     Û    Û  Û  ÛÜÜÜÜ  Û  Û   Û  Û     Ûß        \n");

gotoxy(1,50);
for (patito=0;patito<22;patito++)
  {
  delay(40);
  if(kbhit())
    {
    patito=40;
    }
  }
for (patito=0;patito<30;patito++)
  {
  printf("\n");
  delay(40);
  if(kbhit())
    {
    patito=40;
    }
  }
}


void Inicio()
{
textcolor(0x01);
textbackground(0x00);
clrscr();

for (patito=0;patito<50;patito++)
  {
  printf("    °°°°±±±±²²²²ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ²²²²±±±±°°°°    ");
  }

textcolor(0x0C);
textbackground(0x00);
gotoxy(7,2);    cprintf("ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»");
gotoxy(7,3);    cprintf("º    Patito bros en C por Thierry Joseph Valery Garc¡a Greiner     º");
gotoxy(7,4);    cprintf("º                                                                  º");
gotoxy(7,5);    cprintf("ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼");

gotoxy(7,8);    cprintf("ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»");
gotoxy(7,9);    cprintf("º Modo de video       VGA       º");
gotoxy(7,10);   cprintf("º Compatible                    º");
gotoxy(7,11);   cprintf("º                               º");
gotoxy(7,12);   cprintf("º         Detectado             º");
gotoxy(7,13);   cprintf("º                               º");
gotoxy(7,14);   cprintf("º                               º");
gotoxy(7,15);   cprintf("º                               º");
gotoxy(7,16);   cprintf("º                               º");
gotoxy(7,17);   cprintf("º                               º");
gotoxy(7,18);   cprintf("º                               º");
gotoxy(7,19);   cprintf("º                               º");
gotoxy(7,20);   cprintf("º                               º");
gotoxy(7,21);   cprintf("ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼");

gotoxy(42,8);    cprintf("ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»");
gotoxy(42,9);    cprintf("º Sistemas operativos           º");
gotoxy(42,10);   cprintf("º Compatibles:                  º");
gotoxy(42,11);   cprintf("º                               º");
gotoxy(42,12);   cprintf("º -MSDOS                        º");
gotoxy(42,13);   cprintf("º -Freedos y similares          º");
gotoxy(42,14);   cprintf("º -Windows 95/98/ME             º");
gotoxy(42,15);   cprintf("º -Windows NT/2000/XP           º");
gotoxy(42,16);   cprintf("º                               º");
gotoxy(42,17);   cprintf("º                               º");
gotoxy(42,18);   cprintf("º                               º");
gotoxy(42,19);   cprintf("º                               º");
gotoxy(42,20);   cprintf("º                               º");
gotoxy(42,21);   cprintf("ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼");

gotoxy(8,26);   cprintf("Nota:");
gotoxy(1,27);   cprintf("Las versiones actuales de windows no ejecutan nativamente MSDOS");
gotoxy(1,28);   cprintf("por lo que puede haber problemas al emular. Los problemas conocidos son en:");
gotoxy(1,29);   cprintf("Windows XP/NT: Atraso en la respuesta del teclado o congelamiento");
gotoxy(1,30);   cprintf("Windows Vista y 7: Problemas para iniciar modo gr fico");
gotoxy(1,31);   cprintf("Dosbox: Gr ficos muy lentos. Acelera los ciclos del CPU hasta estabilizar");
gotoxy(1,32);   cprintf("Se recomienda usar un disco de arranque de MSDOS (no en s¡mbolo de sistema)");

textcolor(0xFC);
textbackground(0x01);
gotoxy(24,49);   cprintf("Presiona una tecla para continuar");
}


void errorgraficos()
{
  gotoxy(7,4);    cprintf("ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»");
  gotoxy(7,5);    cprintf("º                      Prueba lo siguiente:                            º");
  gotoxy(7,6);    cprintf("º                                                                      º");
  gotoxy(7,7);    cprintf("º 1 Posiblemente falta el archivo Egavga.bgi                           º");
  gotoxy(7,8);    cprintf("º - Copia el archivo Egavga.bgi que se encuentra en la carpeta BGI     º");
  gotoxy(7,9);    cprintf("º   de tu carpeta de instalacion de Turbo C++ o en la carpeta donde se º");
  gotoxy(7,10);   cprintf("º   encuentra el programa Patito.exe                                   º");
  gotoxy(7,11);   cprintf("º 2 Aumenta la capacidad de memoria para el programa                   º");
  gotoxy(7,12);   cprintf("º 3 Si ejecutaste el programa desde un acceso directo, ejecuta         º");
  gotoxy(7,13);   cprintf("º   directamente el programa.                                          º");
  gotoxy(7,14);   cprintf("º 4 Si lo est s ejecutando desde codigo fuente y marca falta de        º");
  gotoxy(7,15);   cprintf("º   memoria, cambia la generacion del codigo (desde turbo c) en el     º");
  gotoxy(7,16);   cprintf("º   menu \"Options -> Compiler -> Code generation\" y en la parte que    º");
  gotoxy(7,17);   cprintf("º   dice \"Model\" selecciona la opci¢n \"Huge\" y presiona \"OK\"           º");
  gotoxy(7,18);   cprintf("º   Ayuda: Thierry_2222@hotmail.com                                    º");
  gotoxy(7,19);   cprintf("º                                                                      º");
  gotoxy(7,20);   cprintf("ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼");
  gotoxy(7,22);   cprintf("Presiona un tecla para salir.");
  getch();
}


void detectargraficos()
{
//devuelve el valor de la informacion del hardware detectado
int gdriver,gmode,errorcode;

//detectar driver de graficos y modo
detectgraph(&gdriver, &gmode);

//leer resultado de la deteccion de graficos
errorcode=graphresult();

if (errorcode != grOk)  //Si ocurre un error
  {
  textcolor(0x0F);
  textbackground(0x01);
  clrscr();
  gotoxy(7,1);    printf("Error al cargar el driver de graficos: ");
  gotoxy(7,2);    printf("%s", grapherrormsg(errorcode));
  errorgraficos();
  exit(1);
  }
textcolor(0x0F);
gotoxy(9,12);
cprintf("%s",dname[gdriver]);
}


void iniciargraficos()  //16 colores 640x480
{
int gdriver = DETECT, gmode, errorcode;

initgraph(&gdriver, &gmode, "");
errorcode = graphresult();  //comprobar si se inicio correctamente los graficos
if (errorcode != grOk)  //Si ocurre un error
  {
  textcolor(0x0F);
  textbackground(0x01);
  clrscr();
  gotoxy(7,1);    printf("Error al cargar el driver de graficos: ");
  gotoxy(7,2);    printf("%s", grapherrormsg(errorcode));
  errorgraficos();
  exit(1);
  }
}


#ifdef MSDOS
int huge DetectVGA256()
{
int vid;
//0 = 320x200x256
//1 = 640x400x256
//2 = 640x480x256
//3 = 800x600x256
//4 = 1024x768x256
//6 = 1280x1024x256
vid=2;
return vid;
}
#else
int DetectVGA256(){}
void installuserdriver(char *a ,int (*b)()){}
#endif


void iniciargraficos256()  //256 colores
{
int gdriver=DETECT, gmode, errorcode;

installuserdriver("Svga256",DetectVGA256);
initgraph(&gdriver, &gmode, "");
errorcode = graphresult();  //comprobar si se inicio correctamente los graficos
if (errorcode != grOk)  //Si ocurre un error
  {
  clrscr();
  gotoxy(7,1);    printf("Error al cargar el driver de graficos: ");
  gotoxy(7,2);    printf("%s", grapherrormsg(errorcode));
  getch();
  exit(1);
  }
}



//Definiendo funciones para dibujar a color real
// long RGB(char rVal, char gVal, char bVal);
//
// Purpose: Returns the color value for a R,G,B triple
//        based on the current graphics mode.
//
// Input:
//        char rVal - Red value   [0..255]
//        char gVal - Green value [0..255]
//        char bVal - Blue value  [0..255]
//
// Returns:
//         long - Color value for this mode.

#ifdef MSDOS
long _RGB(char rVal, char gVal, char bVal)
{
__rColor xColor;
xColor.c24.rVal = rVal;
xColor.c24.gVal = gVal;
xColor.c24.bVal = bVal;
return (xColor.cval);
}
#else
long _RGB(char rVal, char gVal, char bVal){}
#endif


// long RealDrawColor(long color);
//
// Purpose: Sets the current drawing color for HC/TC modes.
//        Used for 'setcolor'
//
// Input:
//        long color - Color value
//
// Returns:
//        long - Color value

long RealDrawColor(long color)
{
#ifdef MSDOS
__rColor xColor;
xColor.cval = color;
setrgbpalette(1024,xColor.c24.rVal,xColor.c24.gVal,xColor.c24.bVal);
#endif
return color;
}


// long RealFillColor(long color);
//
// Purpose: Sets the current fill color for HC/TC modes.
//        Used for 'setfillstyle' and 'setfillpattern'
//
// Input:
//        long color - Color value
//
// Returns:
//        long - Color value

long RealFillColor(long color)
{
#ifdef MSDOS
__rColor xColor;
xColor.cval = color;
setrgbpalette(1025,xColor.c24.rVal,xColor.c24.gVal,xColor.c24.bVal);
#endif
return color;
}


// long RealColor(long color);
//
// Purpose: Sets the current color for HC/TC modes.
//        Used for 'putpixel' and 'floodfill'
//
// Input:
//        long color - Color value
//
// Returns:
//        long - Color value

long RealColor(long color)
{
#ifdef MSDOS
__rColor xColor;
xColor.cval = color;
setrgbpalette(1026,xColor.c24.rVal,xColor.c24.gVal,xColor.c24.bVal);  //color 24 bits
#endif
return color;
}

#ifdef MSDOS
int huge DetectVGA24bit()  //funcion para elegir el modo grafico
{
int vid;
//0 = 320x200x24-bit
//1 = 640x350x24-bit
//2 = 640x400x24-bit
//3 = 640x480x24-bit
//4 = 800x600x24-bit
//5 = 1024x768x24-bit
//6 = 1280x1024x24-bit
vid=3;
return vid;
}
#else
int DetectVGA24bit() {}
#endif

void iniciargraficos_color_real()  //color real
{
int gdriver = DETECT, gmode, errorcode;

installuserdriver("SvgaTC",DetectVGA24bit);
initgraph(&gdriver,&gmode,"");
errorcode = graphresult();  //comprobar si se inicio correctamente los graficos
if (errorcode != grOk)  //Si ocurre un error
  {
  clrscr();
  gotoxy(7,1);    printf("Error al cargar el driver de graficos: ");
  gotoxy(7,2);    printf("%s", grapherrormsg(errorcode));
  getch();
  exit(1);
  }
}

#ifdef MSDOS
void render_opengl_windows(){}
void wait_foreground(){}



#endif // MSDOS




void abrir(int nivel,int escena)
{
FILE *archivo;
int i,j;

switch (nivel)
  {
  case -3:
    archivo = fopen("present.txt","rb");
  break;
  case -2:
    switch (escena)
      {
      case 0:
        archivo = fopen("-2-0.txt","rb");
      break;
      case 1:
        archivo = fopen("-2-1.txt","rb");
      break;
      case 2:
        archivo = fopen("-2-2.txt","rb");
      break;
      case 3:
        archivo = fopen("-2-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("-2-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 0:
    switch (escena)
      {
      case 0:
        archivo = fopen("0-0.txt","rb");
      break;
      case 1:
        archivo = fopen("0-1.txt","rb");
      break;
      case 2:
        archivo = fopen("0-2.txt","rb");
      break;
      case 3:
        archivo = fopen("0-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("0-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 1:
    switch (escena)
      {
      case 0:
        archivo = fopen("1-0.txt","rb");
      break;
      case 1:
        archivo = fopen("1-1.txt","rb");
      break;
      case 2:
        archivo = fopen("1-2.txt","rb");
      break;
      case 3:
        archivo = fopen("1-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("1-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 2:
    switch (escena)
      {
      case 0:
        archivo = fopen("2-0.txt","rb");
      break;
      case 1:
	archivo = fopen("2-1.txt","rb");
      break;
      case 2:
        archivo = fopen("2-2.txt","rb");
      break;
      case 3:
        archivo = fopen("2-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("2-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 3:
    switch (escena)
      {
      case 0:
        archivo = fopen("3-0.txt","rb");
      break;
      case 1:
        archivo = fopen("3-1.txt","rb");
      break;
      case 2:
        archivo = fopen("3-2.txt","rb");
      break;
      case 3:
        archivo = fopen("3-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("3-20.txt","rb");
      break;
      default:
	archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 4:
    switch (escena)
      {
      case 0:
        archivo = fopen("4-0.txt","rb");
      break;
      case 1:
        archivo = fopen("4-1.txt","rb");
      break;
      case 2:
        archivo = fopen("4-2.txt","rb");
      break;
      case 3:
        archivo = fopen("4-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("4-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 5:
    switch (escena)
      {
      case 0:
        archivo = fopen("5-0.txt","rb");
      break;
      case 1:
        archivo = fopen("5-1.txt","rb");
      break;
      case 2:
        archivo = fopen("5-2.txt","rb");
      break;
      case 3:
        archivo = fopen("5-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("5-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 6:
    switch (escena)
      {
      case 0:
        archivo = fopen("6-0.txt","rb");
      break;
      case 1:
        archivo = fopen("6-1.txt","rb");
      break;
      case 2:
        archivo = fopen("6-2.txt","rb");
      break;
      case 3:
        archivo = fopen("6-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("6-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 7:
    switch (escena)
      {
      case 0:
        archivo = fopen("7-0.txt","rb");
      break;
      case 1:
        archivo = fopen("7-1.txt","rb");
      break;
      case 2:
        archivo = fopen("7-2.txt","rb");
      break;
      case 3:
        archivo = fopen("7-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("7-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 8:
    switch (escena)
      {
      case 0:
        archivo = fopen("8-0.txt","rb");
      break;
      case 1:
        archivo = fopen("8-1.txt","rb");
      break;
      case 2:
        archivo = fopen("8-2.txt","rb");
      break;
      case 3:
        archivo = fopen("8-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("8-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  case 9:
    switch (escena)
      {
      case 0:
        archivo = fopen("9-0.txt","rb");
      break;
      case 1:
        archivo = fopen("9-1.txt","rb");
      break;
      case 2:
        archivo = fopen("9-2.txt","rb");
      break;
      case 3:
        archivo = fopen("9-3.txt","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("9-20.txt","rb");
      break;
      default:
        archivo = fopen("0.txt","rb");
      break;
      }
  break;
  default:
    archivo = fopen("0.txt","rb");
    gotoxy(1,1);
    printf( "No se puede abrir el archivo %i-%i.txt. La funcion abrir() no admite ese nivel    ",nivel,escena);
    tomarletra();
  break;
  }

if (archivo==NULL)
  {
  gotoxy(1,1);
  printf( "No se puede abrir el archivo %i-%i.txt para el mapa del nivel %i escena %i    ",nivel,escena,nivel,escena);
  tomarletra();
  DesinstalaTeclado();
  closegraph();
  exit( 1 );
  }

switch (escena)
  {
  case 0:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&niv0[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  case 1:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&niv1[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  case 2:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&niv2[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  case 3:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&niv3[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  default:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&paisaje[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  }

if (fclose(archivo)!=0)
  {
  gotoxy(1,1);
  printf( "Problemas al cerrar el archivo    \n" );
  }
}


void abrircielo(int nivel,int escena)  //archivo de configuracion del cielo
{
FILE *archivo;
int i,j;

switch (nivel)
  {
  case -3:
    archivo = fopen("present.tim","rb");
  break;
  case -2:
    switch (escena)
      {
      case 0:
        archivo = fopen("-2-0.tim","rb");
      break;
      case 1:
        archivo = fopen("-2-1.tim","rb");
      break;
      case 2:
        archivo = fopen("-2-2.tim","rb");
      break;
      case 3:
        archivo = fopen("-2-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("-2-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");  //aun si el mundo no requiere cielo, se pone para evitar errores
      break;
      }
  break;
  case 0:
    switch (escena)
      {
      case 0:
        archivo = fopen("0-0.tim","rb");
      break;
      case 1:
        archivo = fopen("0-1.tim","rb");
      break;
      case 2:
        archivo = fopen("0-2.tim","rb");
      break;
      case 3:
        archivo = fopen("0-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("0-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 1:
    switch (escena)
      {
      case 0:
        archivo = fopen("1-0.tim","rb");
      break;
      case 1:
        archivo = fopen("1-1.tim","rb");
      break;
      case 2:
        archivo = fopen("1-2.tim","rb");
      break;
      case 3:
        archivo = fopen("1-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("1-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 2:
    switch (escena)
      {
      case 0:
        archivo = fopen("2-0.tim","rb");
      break;
      case 1:
        archivo = fopen("2-1.tim","rb");
      break;
      case 2:
        archivo = fopen("2-2.tim","rb");
      break;
      case 3:
        archivo = fopen("2-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("2-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 3:
    switch (escena)
      {
      case 0:
        archivo = fopen("3-0.tim","rb");
      break;
      case 1:
        archivo = fopen("3-1.tim","rb");
      break;
      case 2:
        archivo = fopen("3-2.tim","rb");
      break;
      case 3:
        archivo = fopen("3-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("3-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 4:
    switch (escena)
      {
      case 0:
        archivo = fopen("4-0.tim","rb");
      break;
      case 1:
        archivo = fopen("4-1.tim","rb");
      break;
      case 2:
        archivo = fopen("4-2.tim","rb");
      break;
      case 3:
        archivo = fopen("4-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("4-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 5:
    switch (escena)
      {
      case 0:
        archivo = fopen("5-0.tim","rb");
      break;
      case 1:
        archivo = fopen("5-1.tim","rb");
      break;
      case 2:
        archivo = fopen("5-2.tim","rb");
      break;
      case 3:
        archivo = fopen("5-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("5-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 6:
    switch (escena)
      {
      case 0:
        archivo = fopen("6-0.tim","rb");
      break;
      case 1:
        archivo = fopen("6-1.tim","rb");
      break;
      case 2:
        archivo = fopen("6-2.tim","rb");
      break;
      case 3:
        archivo = fopen("6-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("6-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 7:
    switch (escena)
      {
      case 0:
        archivo = fopen("7-0.tim","rb");
      break;
      case 1:
        archivo = fopen("7-1.tim","rb");
      break;
      case 2:
        archivo = fopen("7-2.tim","rb");
      break;
      case 3:
	archivo = fopen("7-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("7-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 8:
    switch (escena)
      {
      case 0:
        archivo = fopen("8-0.tim","rb");
      break;
      case 1:
        archivo = fopen("8-1.tim","rb");
      break;
      case 2:
        archivo = fopen("8-2.tim","rb");
      break;
      case 3:
        archivo = fopen("8-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("8-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  case 9:
    switch (escena)
      {
      case 0:
        archivo = fopen("9-0.tim","rb");
      break;
      case 1:
        archivo = fopen("9-1.tim","rb");
      break;
      case 2:
        archivo = fopen("9-2.tim","rb");
      break;
      case 3:
        archivo = fopen("9-3.tim","rb");
      break;
      case 20:  //escena secreta
        archivo = fopen("9-20.tim","rb");
      break;
      default:
        archivo = fopen("0.tim","rb");
      break;
      }
  break;
  default:
    archivo = fopen("0.tim","rb");
    gotoxy(1,1);
    printf( "No se puede abrir el archivo %i-%i.tim. La funcion abrircielo() no admite ese nivel    ",nivel,escena);
    tomarletra();
  break;
  }

if (archivo==NULL)
  {
  gotoxy(1,1);
  printf( "No se puede abrir el archivo %i-%i.tim para el mapa del nivel %i escena %i    ",nivel,escena,nivel,escena);
  tomarletra();
  DesinstalaTeclado();
  closegraph();
  exit( 1 );
  }

switch (escena)
  {
  case 0:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&cieloniv0[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  case 1:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&cieloniv1[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  case 2:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&cieloniv2[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  case 3:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
	fscanf(archivo,"%d,",&cieloniv3[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  default:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        fscanf(archivo,"%d,",&colorcielo[j][i]);
        }
      (void) getc(archivo);  //para el retorno
      }
  break;
  }
if (fclose(archivo)!=0)
  {
  gotoxy(1,1);
  printf( "Problemas al cerrar el archivo    \n" );
  }
}


void r_mina()  //resetear minas
{
int i;
for(i=0;i<8;i++)
  {
  nmina[i]=0;
  minax[i]=-200;
  minay[i]=-200;
  minao[i]=-200;
  minap[i]=-200;
  }
npc[4]=0;
}


void r_champ()  //resetear champiñones
{
int i;
for(i=0;i<4;i++)
  {
  nchamp[i]=0;
  champx[i]=-200;  //para que no borre el pedacito de pantalla al iniciar
  champy[i]=-200;
  champo[i]=-200;
  champp[i]=-200;
  }
}


void rmonedas()  //resetear monedas
{
int i;
for(i=0;i<4;i++)
  {
  nmonedas[i]=0;
  monedax[i]=0;
  moneday[i]=0;
  }
}


void c_mina(int i, int j)
{
int n,m=0;
i=i*16;
j=j*16;
for(n=0;n<8;n++)
  {
  if(nmina[n]==0)
    {
    m=n;
    nmina[n]=1;
    minao[m]=i;
    minap[m]=j;
    n=8;
    }
  }
minax[m]=i;
minay[m]=j;
npc[4]=1;
}


void c_champ(int i, int j, int T)
{
int n,p=0;
i=i*16;
j=j*16;
if(T<6)
  {
  for(n=0;n<4;n++)
    {
    if(nchamp[n]==0)
      {
      p=n;
      if(x>(i*16))
        {
        nchamp[n]=-T;
        }
      else
        {
        nchamp[n]=T;
        }
      champo[p]=i;  //para que no refresque otra seccion de la pantalla cuando es creado
      champp[p]=j;
      n=4;
      }
    }
  champx[p]=i;
  champy[p]=j;
  }
}


void cmoneda(int i, int j)
{
int n;
for(n=0;n<4;n++)
  {
  if(nmonedas[n]==0)
    {
    nmonedas[n]=1;
    i=i*16;
    j=j*16;
    monedax[n]=i;
    moneday[n]=j;
    n=4;
    }
  }
}


void movmina()
{
int n,e1,e2,e3,e4;
for(n=0;n<8;n++)
  {
  if(nmina[n]!=0)
    {
    e1=0;
    e2=0;
    e3=0;
    e4=0;
    if(minax[n]>x)  //seguir pato en tiempo real, seguir en x
      {
      minax[n]--;
      }
    else if(minax[n]<x)
      {
      minax[n]++;
      }
    if(minay[n]>y)  //seguir en y
      {
      minay[n]--;
      }
    else if(minay[n]<y)
      {
      minay[n]++;
      }
    if(paisaje[(minay[n]-(minay[n]%16))/16][(minax[n]-(minax[n]%16))/16]<32)  //limite esquina izquierda superior
      {
      e1=1;
      }
    if(paisaje[(minay[n]-(minay[n]%16))/16][(minax[n]+15-((minax[n]+15)%16))/16]<32)  //limite esquina derecha superior
      {
      e2=1;
      }
    if(paisaje[(minay[n]+15-((minay[n]+15)%16))/16][(minax[n]+15-((minax[n]+15)%16))/16]<32)  //limite esquina derecha inferior
      {
      e4=1;
      }
    if(paisaje[(minay[n]+15-((minay[n]+15)%16))/16][(minax[n]-(minax[n]%16))/16]<32)  //limite esquina izquierda inferior
      {
      e3=1;
      }
    if(e1==1 && e2==1)
      {
      minay[n]++;
      }
    if(e1==1 && e3==1)
      {
      minax[n]++;
      }
    if(e2==1 && e4==1)
      {
      minax[n]--;
      }
    if(e3==1 && e4==1)
      {
      minay[n]--;
      }
    }
  }
}


void movchamp()
{
int n;
for(n=0;n<4;n++)
  {
  if(nchamp[n]!=0)
    {
    if(nchamp[n]>0)  //determinar sentido
      {
      champx[n]++;
      }
    if(nchamp[n]<0)  //determinar sentido
      {
      champx[n]--;
      }
    if((champx[n]%16)!=0)
      {
      if(paisaje[(champy[n]+16-(champy[n]%16))/16][(champx[n]-(champx[n]%16))/16]>=32 && paisaje[(champy[n]+16-(champy[n]%16))/16][(champx[n]+16-(champx[n]%16))/16]>=32)  //gravedad verificando si el bloque de abajo a la izquierda o el bloque de abajo a la derecha es aire
        {
        champy[n]=champy[n]+4;
        }
      else
        {
        champy[n]=champy[n]-(champy[n]%16);
        }
      }
    else
      {
      if(paisaje[(champy[n]+16-(champy[n]%16))/16][(champx[n]-(champx[n]%16))/16]>=32)  //gravedad verificando si el bloque de abajo a la izquierda es aire
        {
        champy[n]=champy[n]+4;
        }
      else
        {
        champy[n]=champy[n]-(champy[n]%16);
        }
      }
    if(paisaje[(champy[n]-(champy[n]%16))/16][(champx[n]+16-(champx[n]%16))/16]<32) //limite de bloque derecho
      {
      nchamp[n]=-nchamp[n];
      champx[n]=champx[n]-(champx[n]%16);
      }
    else if(paisaje[(champy[n]-(champy[n]%16))/16][(champx[n]-(champx[n]%16))/16]<32) //limite de bloque izquierdo
      {
      nchamp[n]=-nchamp[n];
      champx[n]=champx[n]+16-(champx[n]%16);
      }
    }
  }
}


void dibmina()
{
int n,i,j;
for(n=0;n<8;n++)
  {
  if(nmina[n]!=0)
    {
    for(j=0;j<16;j++)
      {
      for(i=0;i<16;i++)
	{
        if(mina0[j][i]!=22)
          {
          putpixel(minax[n]+i,minay[n]+j,mina0[j][i]);
          }
        }
      }
    }
  }
}


void dibchamp()
{
int n,i,j;
for(n=0;n<4;n++)
  {
  if(nchamp[n]!=0)
    {
    switch (nchamp[n])
      {
      case -5:
        for(j=0;j<16;j++)
          {
          for(i=0;i<16;i++)
            {
            if(calavera0[j][i]!=22)
              {
              putpixel(champx[n]+i,champy[n]+j,calavera0[j][i]);
              }
            }
          }
      break;
      case -4:
        for(j=0;j<16;j++)
	  {
          for(i=0;i<16;i++)
            {
            if(champi4[j][i]!=22)
              {
              putpixel(champx[n]+i,champy[n]+j,champi4[j][i]);
              }
            }
          }
      break;
      case -1:
        for(j=0;j<16;j++)
          {
          for(i=0;i<16;i++)
            {
            if(champi0[j][i]!=22)
              {
              putpixel(champx[n]+i,champy[n]+j,champi0[j][i]);
              }
            }
          }
      break;
      case 1:
        for(j=0;j<16;j++)
          {
          for(i=0;i<16;i++)
            {
            if(champi4[j][i]!=22)
              {
              putpixel(champx[n]+i,champy[n]+j,champi0[j][i]);
              }
            }
          }
      break;
      case 4:
	for(j=0;j<16;j++)
          {
          for(i=0;i<16;i++)
            {
            if(champi4[j][i]!=22)
              {
              putpixel(champx[n]+i,champy[n]+j,champi4[j][i]);
              }
            }
          }
      break;
      case 5:
        for(j=0;j<16;j++)
          {
          for(i=0;i<16;i++)
            {
            if(calavera0[j][i]!=22)
              {
              putpixel(champx[n]+i,champy[n]+j,calavera0[j][i]);
              }
            }
          }
      break;
      }
    }
  }
}


void elichamp(int i)
{
//borrando variables
nchamp[i]=0;
champx[i]=0;
champy[i]=0;
//borrando rastro del dibujo, redibujando fondo
if((champo[i]%16)!=0)  // comprobar que bloques necesitan actualizarse
  {
  bloque(champo[i]-(champo[i]%16),champp[i]-(champp[i]%16),paisaje[(champp[i]-(champp[i]%16))/16][(champo[i]-(champo[i]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
  bloque(champo[i]-(champo[i]%16)+16,champp[i]-(champp[i]%16),paisaje[(champp[i]-(champp[i]%16))/16][(champo[i]+16-(champo[i]%16))/16]);  //actualizar bloque que esta arriba a la derecha
  if((champp[i]%16)!=0)
    {
    bloque(champo[i]-(champo[i]%16),champp[i]-(champp[i]%16)+16,paisaje[(champp[i]+16-(champp[i]%16))/16][(champo[i]-(champo[i]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
    bloque(champo[i]-(champo[i]%16)+16,champp[i]-(champp[i]%16)+16,paisaje[(champp[i]+16-(champp[i]%16))/16][(champo[i]+16-(champo[i]%16))/16]);  //actualizar bloque que esta abajo a la derecha
    }
  }
else if((champp[i]%16)!=0)
  {
  bloque(champo[i]-(champo[i]%16),champp[i]-(champp[i]%16),paisaje[(champp[i]-(champp[i]%16))/16][(champo[i]-(champo[i]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
  bloque(champo[i]-(champo[i]%16),champp[i]-(champp[i]%16)+16,paisaje[(champp[i]+16-(champp[i]%16))/16][(champo[i]-(champo[i]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
  }
else
  {
  bloque(champo[i],champp[i],paisaje[champp[i]/16][champo[i]/16]);  //actualizar bloque que esta en su posicion
  }
}


void elimina(int i)  //eliminar minas
{
//borrando variables
nmina[i]=0;
minax[i]=0;
minay[i]=0;
//borrando rastro del dibujo, redibujando fondo
if((minao[i]%16)!=0)  // comprobar que bloques necesitan actualizarse
  {
  bloque(minao[i]-(minao[i]%16),minap[i]-(minap[i]%16),paisaje[(minap[i]-(minap[i]%16))/16][(minao[i]-(minao[i]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
  bloque(minao[i]-(minao[i]%16)+16,minap[i]-(minap[i]%16),paisaje[(minap[i]-(minap[i]%16))/16][(minao[i]+16-(minao[i]%16))/16]);  //actualizar bloque que esta arriba a la derecha
  if((minap[i]%16)!=0)
    {
    bloque(minao[i]-(minao[i]%16),minap[i]-(minap[i]%16)+16,paisaje[(minap[i]+16-(minap[i]%16))/16][(minao[i]-(minao[i]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
    bloque(minao[i]-(minao[i]%16)+16,minap[i]-(minap[i]%16)+16,paisaje[(minap[i]+16-(minap[i]%16))/16][(minao[i]+16-(minao[i]%16))/16]);  //actualizar bloque que esta abajo a la derecha
    }
  }
else if((minap[i]%16)!=0)
  {
  bloque(minao[i]-(minao[i]%16),minap[i]-(minap[i]%16),paisaje[(minap[i]-(minap[i]%16))/16][(minao[i]-(minao[i]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
  bloque(minao[i]-(minao[i]%16),minap[i]-(minap[i]%16)+16,paisaje[(minap[i]+16-(minap[i]%16))/16][(minao[i]-(minao[i]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
  }
else
  {
  bloque(minao[i],minap[i],paisaje[minap[i]/16][minao[i]/16]);  //actualizar bloque que esta en su posicion
  }
}


void posicion_champ()
{
int n;
for(n=0;n<4;n++)
  {
  if(nchamp[n]!=0)
    {
    champo[n]=champx[n];
    champp[n]=champy[n];
    }
  }
}


void posicion_mina()
{
int n;
for(n=0;n<8;n++)
  {
  if(nmina[n]!=0)
    {
    minao[n]=minax[n];
    minap[n]=minay[n];
    }
  }
}


void posicion_disparo()
{
int n;
for(n=0;n<4;n++)
  {
  if(ndisparo[n]!=0)
    {
    disparoo[n]=disparox[n];
    disparop[n]=disparoy[n];
    }
  }
}


void refchamp()
{
int n;
for(n=0;n<4;n++)
  {
  if(nchamp[n]!=0)
    {
    if((champo[n]%16)!=0)  // comprobar que bloques necesitan actualizarse
      {
      bloque(champo[n]-(champo[n]%16),champp[n]-(champp[n]%16),paisaje[(champp[n]-(champp[n]%16))/16][(champo[n]-(champo[n]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
      bloque(champo[n]-(champo[n]%16)+16,champp[n]-(champp[n]%16),paisaje[(champp[n]-(champp[n]%16))/16][(champo[n]+16-(champo[n]%16))/16]);  //actualizar bloque que esta arriba a la derecha
      if((champp[n]%16)!=0)
        {
        bloque(champo[n]-(champo[n]%16),champp[n]-(champp[n]%16)+16,paisaje[(champp[n]+16-(champp[n]%16))/16][(champo[n]-(champo[n]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
        bloque(champo[n]-(champo[n]%16)+16,champp[n]-(champp[n]%16)+16,paisaje[(champp[n]+16-(champp[n]%16))/16][(champo[n]+16-(champo[n]%16))/16]);  //actualizar bloque que esta abajo a la derecha
        }
      }
    else if((champp[n]%16)!=0)
      {
      bloque(champo[n]-(champo[n]%16),champp[n]-(champp[n]%16),paisaje[(champp[n]-(champp[n]%16))/16][(champo[n]-(champo[n]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
      bloque(champo[n]-(champo[n]%16),champp[n]-(champp[n]%16)+16,paisaje[(champp[n]+16-(champp[n]%16))/16][(champo[n]-(champo[n]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
      }
    else
      {
      bloque(champo[n],champp[n],paisaje[champp[n]/16][champo[n]/16]);  //actualizar bloque que esta en su posicion
      }
    }
  }
}


void refmina()
{
int n;
for(n=0;n<8;n++)
  {
  if(nmina[n]!=0)
    {
    if((minao[n]%16)!=0)  // comprobar que bloques necesitan actualizarse
      {
      bloque(minao[n]-(minao[n]%16),minap[n]-(minap[n]%16),paisaje[(minap[n]-(minap[n]%16))/16][(minao[n]-(minao[n]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
      bloque(minao[n]-(minao[n]%16)+16,minap[n]-(minap[n]%16),paisaje[(minap[n]-(minap[n]%16))/16][(minao[n]+16-(minao[n]%16))/16]);  //actualizar bloque que esta arriba a la derecha
      if((minap[n]%16)!=0)
        {
        bloque(minao[n]-(minao[n]%16),minap[n]-(minap[n]%16)+16,paisaje[(minap[n]+16-(minap[n]%16))/16][(minao[n]-(minao[n]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
        bloque(minao[n]-(minao[n]%16)+16,minap[n]-(minap[n]%16)+16,paisaje[(minap[n]+16-(minap[n]%16))/16][(minao[n]+16-(minao[n]%16))/16]);  //actualizar bloque que esta abajo a la derecha
        }
      }
    else if((minap[n]%16)!=0)
      {
      bloque(minao[n]-(minao[n]%16),minap[n]-(minap[n]%16),paisaje[(minap[n]-(minap[n]%16))/16][(minao[n]-(minao[n]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
      bloque(minao[n]-(minao[n]%16),minap[n]-(minap[n]%16)+16,paisaje[(minap[n]+16-(minap[n]%16))/16][(minao[n]-(minao[n]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
      }
    else
      {
      bloque(minao[n],minap[n],paisaje[minap[n]/16][minao[n]/16]);  //actualizar bloque que esta en su posicion
      }
    }
  }
}


void mdemone()  //mover dibujar eliminar moneda
{
int n,i,j;
for(n=0;n<4;n++)
  {
  if(nmonedas[n]!=0)
    {
    bloque(monedax[n]-(monedax[n]%16),moneday[n]-(moneday[n]%16),paisaje[(moneday[n]-(moneday[n]%16))/16][(monedax[n]-(monedax[n]%16))/16]);
    bloque(monedax[n]-(monedax[n]%16),moneday[n]+16-(moneday[n]%16),paisaje[(moneday[n]+16-(moneday[n]%16))/16][(monedax[n]-(monedax[n]%16))/16]);
    if(monealt[n]>-32)
      {
      monealt[n]=monealt[n]-4;
      moneday[n]=moneday[n]-4;
      setfillstyle(1,colorcielo[(moneday[n]-(moneday[n]%16))/16][(monedax[n]-(monedax[n]%16))/16]);
      bar(monedax[n],moneday[n],monedax[n]+15,moneday[n]+15);
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(moneda0[j][i]!=22)
            {
            putpixel(i+monedax[n],j+moneday[n],moneda0[j][i]);
            }
          }
        }
      }
    else if(monealt[n]>-64)
      {
      monealt[n]=monealt[n]-4;
      moneday[n]=moneday[n]+4;
      setfillstyle(1,colorcielo[(moneday[n]-(moneday[n]%16))/16][(monedax[n]-(monedax[n]%16))/16]);
      bar(monedax[n],moneday[n],monedax[n]+15,moneday[n]+15);
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
	  if(moneda0[j][i]!=22)
            {
            putpixel(i+monedax[n],j+moneday[n],moneda0[j][i]);
            }
          }
        }
      }
    else
      {
      nmonedas[n]=0;
      monealt[n]=0;
      moneday[n]=0;
      monedax[n]=0;
      }
    }
  }
}


void convertir()  //convertir bloques y monedas
{
int i,j;
t_moneda=tiempo-22;
for(j=0;j<30;j++)
  {
  for(i=0;i<40;i++)
    {
    if(paisaje[j][i]==14)
      {
      paisaje[j][i]=35;
      bloque(i*16,j*16,35);
      }
    else if(paisaje[j][i]==15)
      {
      paisaje[j][i]=34;
      bloque(i*16,j*16,34);
      }
    else if(paisaje[j][i]==34)
      {
      paisaje[j][i]=15;
      bloque(i*16,j*16,15);
      }
    else if(paisaje[j][i]==35)
      {
      paisaje[j][i]=14;
      bloque(i*16,j*16,14);
      }
    if(niv0[j][i]==14)
      {
      niv0[j][i]=35;
      }
    else if(niv0[j][i]==15)
      {
      niv0[j][i]=34;
      }
    else if(niv0[j][i]==34)
      {
      niv0[j][i]=15;
      }
    else if(niv0[j][i]==35)
      {
      niv0[j][i]=14;
      }
    if(niv1[j][i]==14)
      {
      niv1[j][i]=35;
      }
    else if(niv1[j][i]==15)
      {
      niv1[j][i]=34;
      }
    else if(niv1[j][i]==34)
      {
      niv1[j][i]=15;
      }
    else if(niv1[j][i]==35)
      {
      niv1[j][i]=14;
      }
    if(niv2[j][i]==14)
      {
      niv2[j][i]=35;
      }
    else if(niv2[j][i]==15)
      {
      niv2[j][i]=34;
      }
    else if(niv2[j][i]==34)
      {
      niv2[j][i]=15;
      }
    else if(niv2[j][i]==35)
      {
      niv2[j][i]=14;
      }
    if(niv3[j][i]==14)
      {
      niv3[j][i]=35;
      }
    else if(niv3[j][i]==15)
      {
      niv3[j][i]=34;
      }
    else if(niv3[j][i]==34)
      {
      niv3[j][i]=15;
      }
    else if(niv3[j][i]==35)
      {
      niv3[j][i]=14;
      }
    }
  }
}


void convertbloqmon()
{
int i,j;
if(t_moneda>0)
  {
  for(j=0;j<30;j++)
    {
    for(i=0;i<40;i++)
      {
      if(paisaje[j][i]==14)
        {
        paisaje[j][i]=35;
        }
      else if(paisaje[j][i]==15)
        {
        paisaje[j][i]=34;
        }
      else if(paisaje[j][i]==34)
        {
        paisaje[j][i]=15;
        }
      else if(paisaje[j][i]==35)
        {
        paisaje[j][i]=14;
	  }
      }
    }
  }
}


void act_cielo(int T)
{
int i,j;
switch (T)
  {
  case 0:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        colorcielo[j][i]=cieloniv0[j][i];
        }
      }
  break;
  case 1:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        colorcielo[j][i]=cieloniv1[j][i];
        }
      }
  break;
  case 2:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
	colorcielo[j][i]=cieloniv2[j][i];
        }
      }
  break;
  case 3:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        colorcielo[j][i]=cieloniv3[j][i];
        }
      }
  break;
  }
}


void act_fondo(int T)
{
int i,j;
switch (T)
  {
  case 0:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        paisaje[j][i]=niv0[j][i];
        }
      }
  break;
  case 1:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
	{
        paisaje[j][i]=niv1[j][i];
        }
      }
  break;
  case 2:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        paisaje[j][i]=niv2[j][i];
        }
      }
  break;
  case 3:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        paisaje[j][i]=niv3[j][i];
        }
      }
  break;
  }
}


void guardar_fondo(int T)
{
int i,j;
switch (T)
  {
  case 0:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        niv0[j][i]=paisaje[j][i];
        }
      }
  break;
  case 1:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        niv1[j][i]=paisaje[j][i];
        }
      }
  break;
  case 2:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        niv2[j][i]=paisaje[j][i];
        }
      }
  break;
  case 3:
    for(j=0;j<30;j++)
      {
      for(i=0;i<40;i++)
        {
        niv3[j][i]=paisaje[j][i];
        }
      }
  break;
  }
}


void fondo()
{
int i,j;
for(j=0;j<30;j++)
  {
  for(i=0;i<40;i++)
    {
    bloque(i*16,j*16,paisaje[j][i]);
    }
  }
}

void fondomundo()  //aguas fondomundo() no es lo mismo que fondo() por bloque() y bloque0()
{
int i,j;
for(j=0;j<30;j++)
  {
  for(i=0;i<40;i++)
    {
    bloque0(i*16,j*16,paisaje[j][i]);
    }
  }
}


void refbloques()  //actualizar bloques personaje principal
{
                 //el modulo es para que aparesca el bloque alineado a los demas
  if((o%16)!=0)  // comprobar que bloques necesitan actualizarse
    {
    bloque(o-(o%16),p-(p%16),paisaje[(p-(p%16))/16][(o-(o%16))/16]);  //actualizar bloque que esta arriba a la izquierda
    bloque(o-(o%16)+16,p-(p%16),paisaje[(p-(p%16))/16][(o+16-(o%16))/16]);  //actualizar bloque que esta arriba a la derecha
    if((p%16)!=0)
      {
      bloque(o-(o%16),p-(p%16)+16,paisaje[(p+16-(p%16))/16][(o-(o%16))/16]);  //actualizar bloque que esta abajo a la izquierda
      bloque(o-(o%16)+16,p-(p%16)+16,paisaje[(p+16-(p%16))/16][(o+16-(o%16))/16]);  //actualizar bloque que esta abajo a la derecha
      }
    }
  else if((p%16)!=0)
    {
    bloque(o-(o%16),p-(p%16),paisaje[(p-(p%16))/16][(o-(o%16))/16]);  //actualizar bloque que esta arriba a la izquierda
    bloque(o-(o%16),p-(p%16)+16,paisaje[(p+16-(p%16))/16][(o-(o%16))/16]);  //actualizar bloque que esta abajo a la izquierda
    }
  else
    {
    bloque(o,p,paisaje[p/16][o/16]);  //actualizar bloque que esta arriba a la izquierda, el bloque que esta en su posicion
    }
}


void refbloquemundo()  //actualizar bloques personaje principal en seleccion de mundo
{
                 //el modulo es para que aparesca el bloque alineado a los demas
  if((x%16)!=0)  // comprobar que bloques necesitan actualizarse
    {
    bloque0(x-(x%16),y-(y%16),paisaje[(y-(y%16))/16][(x-(x%16))/16]);  //actualizar bloque que esta arriba a la izquierda
    bloque0(x-(x%16)+16,y-(y%16),paisaje[(y-(y%16))/16][(x+16-(x%16))/16]);  //actualizar bloque que esta arriba a la derecha
    if((y%16)!=0)
      {
      bloque0(x-(x%16),y-(y%16)+16,paisaje[(y+16-(y%16))/16][(x-(x%16))/16]);  //actualizar bloque que esta abajo a la izquierda
      bloque0(x-(x%16)+16,y-(y%16)+16,paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]);  //actualizar bloque que esta abajo a la derecha
      }
    }
  else if((y%16)!=0)
    {
    bloque0(x-(x%16),y-(y%16),paisaje[(y-(y%16))/16][(x-(x%16))/16]);  //actualizar bloque que esta arriba a la izquierda
    bloque0(x-(x%16),y-(y%16)+16,paisaje[(y+16-(y%16))/16][(x-(x%16))/16]);  //actualizar bloque que esta abajo a la izquierda
    }
  else
    {
    bloque0(x,y,paisaje[y/16][x/16]);  //actualizar bloque que esta arriba a la izquierda, el bloque que esta en su posicion
    }
}


void tinvensible()
{
if(invensible!=0)
  {
  invensible--;
  }
}


void bloque_poder0()  //poder0
{
if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==36)  //poder0
  {
  if(vy>4) //velocidad de ruptura
    {
    vy=-vy+2.0;
    y=y+16-(y%16);
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=37;  //poder2
    bloque(x-(x%16),y-(y%16),37);
    convertir();
    }
  else
    {
    vy=0;
    y=y-(y%16);
    }
  if(tecla[KEY_CUR_ARRIBA])
    {
    vy=-8;
    }
  }
else if((paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==36) && x%16!=0)  //poder0
  {
  if(vy>4) //velocidad de ruptura
    {
    vy=-vy+2.0;
    y=y+16-(y%16);
    paisaje[(y-(y%16))/16][(x+16-(x%16))/16]=37;  //poder2
    bloque(x+16-(x%16),y-(y%16),37);
    convertir();
    }
  else
    {
    vy=0;
    y=y-(y%16);
    }
  if(tecla[KEY_CUR_ARRIBA])
    {
    vy=-8;
    }
  }
if(paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]==36 && (y%16)==0 ) //limite derecho del patito con poder0
  {
  vx=0.0;
  x=x-(x%16);
  }
else if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==36 && (y%16)==0 ) //limite izquierdo del patito con poder0
  {
  vx=0.0;
  x=x+16-(x%16);
  }
}


void bloque_caja0_moneda()  //caja0 con moneda
{
  if(c1==1) //caja0 con moneda  //if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==1)
    {
    //vy=-vy;
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    cmoneda((x-(x%16))/16,(y-16-(y%16))/16);
    }
  else if(c2==1)  //else if(paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==1 && x%16!=0)
    {
    //vy=-vy;
    puntos=puntos+40;
    monedas++;
    //paisaje[(y-(y%16))/16][(x+16-(x%16))/16]=5;
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    //bloque(x+16-(x%16),y-(y%16),5);
    bloque(x+15-((x+15)%16),y-(y%16),5);
    cmoneda((x+16-(x%16))/16,(y-16-(y%16))/16);
    }
}


void bloque_caja0_10monedas()  //caja0 con 10 momedas
{
  if(c1==2) //caja0 con 10 monedas
    {
    cajamone++;
    monedas++;
    puntos=puntos+40;
    cmoneda((x-(x%16))/16,(y-16-(y%16))/16);
    if(cajamone>=10)
      {
      paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;
      bloque(x-(x%16),y-(y%16),5);
      cajamone=0;
      }
    }
  else if(c2==2)
    {
    cajamone++;
    monedas++;
    puntos=puntos+40;
    cmoneda((x+16-(x%16))/16,(y-16-(y%16))/16);
    if(cajamone>=10)
      {
      paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
      bloque(x+15-((x+15)%16),y-(y%16),5);
      cajamone=0;
      }
    }
}


void bloque_caja0_champinon()  //caja0 con champiñon
{
  if(c1==3)  //caja0 con champiñon
    {
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    c_champ((x-(x%16))/16,(y-16-(y%16))/16,1);
    }
  else if(c2==3)
    {
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    c_champ((x+16-(x%16))/16,(y-16-(y%16))/16,1);
    }
}


void bloque_caja0_vida()  //caja0 con vida
{
  if(c1==4)  //caja0 con vida
    {
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    c_champ((x-(x%16))/16,(y-16-(y%16))/16,4);
    }
  else if(c2==4)
    {
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    c_champ((x+16-(x%16))/16,(y-16-(y%16))/16,4);
    }
}


void estrella_moneda()  //estrellas con moneda
{
if(c1==51) //estrellas con moneda
  {
  if(vy<=0)
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    cmoneda((x-(x%16))/16,(y-16-(y%16))/16);
    }
  }
else if(c2==51)
  {
  if(vy<=0)
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    cmoneda((x+16-(x%16))/16,(y-16-(y%16))/16);
    }
  }
}


void cielo_vida()  //cielo cyan con vida
{
if(c1==32)  //cielo cyan con vida
  {
  if(vy<=0)
    {
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    c_champ((x-(x%16))/16,(y-16-(y%16))/16,4);
    }
  }
else if(c2==32)
  {
  if(vy<=0)
    {
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    c_champ((x+16-(x%16))/16,(y-16-(y%16))/16,4);
    }
  }
}


void cielo_moneda()  //cielo cyan con moneda
{
if(c1==33) //cielo cyan con moneda
  {
  if(vy<=0)
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    cmoneda((x-(x%16))/16,(y-16-(y%16))/16);
    }
  }
else if(c2==33)
  {
  if(vy<=0)
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    cmoneda((x+16-(x%16))/16,(y-16-(y%16))/16);
    }
  }
}


void cristal0_moneda()  //cristal con moneda
{
  if(c1==16) //cristal con moneda
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    cmoneda((x-(x%16))/16,(y-16-(y%16))/16);
    }
  else if(c2==16)
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    cmoneda((x+16-(x%16))/16,(y-16-(y%16))/16);
    }
}


void cristal4_moneda()  //cristal con moneda
{
  if(c1==17) //cristal con moneda
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    cmoneda((x-(x%16))/16,(y-16-(y%16))/16);
    }
  else if(c2==17)
    {
    puntos=puntos+40;
    monedas++;
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    cmoneda((x+16-(x%16))/16,(y-16-(y%16))/16);
    }
}


void cristal0_vida()  //cristal0 con vida
{
  if(c1==18)  //cristal0 con vida
    {
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    c_champ((x-(x%16))/16,(y-16-(y%16))/16,4);
    }
  else if(c2==18)
    {
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    c_champ((x+16-(x%16))/16,(y-16-(y%16))/16,4);
    }
}


void cristal4_vida()  //cristal4 con vida
{
  if(c1==19)  //cristal0 con vida
    {
    paisaje[(y-(y%16))/16][(x-(x%16))/16]=5;  //caja5
    bloque(x-(x%16),y-(y%16),5);
    c_champ((x-(x%16))/16,(y-16-(y%16))/16,4);
    }
  else if(c2==19)
    {
    paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=5;
    bloque(x+15-((x+15)%16),y-(y%16),5);
    c_champ((x+16-(x%16))/16,(y-16-(y%16))/16,4);
    }
}


void bloque_cristal()  //cristal golpe por abajo
{
int colorfondo;
char e1,e2,e3,e4;
  if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==14 || paisaje[(y-(y%16))/16][(x-(x%16))/16]==15)  //detecion de solidos para la esquina izquierda superior
    {
    e1=1;
    }
  else
    {
    e1=0;
    }
  if(paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]==14 || paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]==15)  //detecion de solidos para la esquina derecha superior
    {
    e2=1;
    }
  else
    {
    e2=0;
    }
  if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==14 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==15)  //detecion de solidos para la esquina izquierda inferior
    {
    e3=1;
    }
  else
    {
    e3=0;
    }
  if(paisaje[(y+16-(y%16))/16][(x+15-((x+15)%16))/16]==14 || paisaje[(y+16-(y%16))/16][(x+15-((x+15)%16))/16]==15)  //detecion de solidos para la esquina derecha inferior
    {
    e4=1;
    }
  else
    {
    e4=0;
    }
//       e1----e2
//        |     |
//        |     |
//       e3----e4
  if(e1==1 && e2==1 && e3==0 && e4==0)
    {
    if(estado>1)
      {
      vy=vy+8;
      colorfondo=colorcielo[(y-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
      paisaje[(y-(y%16))/16][(x-(x%16))/16]=colorfondo;
      bloque(x-(x%16),y-(y%16),colorfondo);
      c_cristalroto(x-(x%16),y-(y%16));
      colorfondo=colorcielo[(y-(y%16))/16][(x+15-((x+15)%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
      paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=colorfondo;
      bloque(x+15-((x+15)%16),y-(y%16),colorfondo);
      c_cristalroto(x+15-((x+15)%16),y-(y%16));
      }
    else
      {
      y=y+16-(y%16);
      vy=-vy;
      }
    }
  if(e1==1 && e2==0 && e3==0 && e4==0)
    {
    if(estado>1 && vy<0.0)
      {
      vy=vy+8;
      colorfondo=colorcielo[(y-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
      paisaje[(y-(y%16))/16][(x-(x%16))/16]=colorfondo;
      bloque(x-(x%16),y-(y%16),colorfondo);
      c_cristalroto(x-(x%16),y-(y%16));
      }
    }
  if(e1==0 && e2==1 && e3==0 && e4==0)
    {
    if(estado>1 && vy<0.0)
      {
      vy=vy+8;
      colorfondo=colorcielo[(y-(y%16))/16][(x+15-((x+15)%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
      paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=colorfondo;
      bloque(x+15-((x+15)%16),y-(y%16),colorfondo);
      c_cristalroto(x+15-((x+15)%16),y-(y%16));
      }
    }
  if(e1==1 && e2==1 && e3==1 && e4==0)
    {
    vx=0.0;
    x=x+16-(x%16);
    if(estado>1 && vy<0.0)
      {
      vy=vy+8;
      colorfondo=colorcielo[(y-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
      paisaje[(y-(y%16))/16][(x-(x%16))/16]=colorfondo;
      bloque(x-(x%16),y-(y%16),colorfondo);
      c_cristalroto(x-(x%16),y-(y%16));
      }
    else
      {
      vy=-vy;
      }
    }
  if(e1==1 && e2==1 && e3==0 && e4==1)
    {
    vx=0.0;
    x=x-(x%16);
    if(estado>1 && vy<0.0)
      {
      vy=vy+8;
      colorfondo=colorcielo[(y-(y%16))/16][(x+15-((x+15)%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
      paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]=colorfondo;
      bloque(x+15-((x+15)%16),y-(y%16),colorfondo);
      c_cristalroto(x+15-((x+15)%16),y-(y%16));
      }
    else
      {
      vy=-vy;
      }
    }
  if(e1==1 && e2==1 && e3==1 && e4==1)
    {
    //El personaje esta atorado. no hacer nada
    }
}


void bloque_moneda0()  //monedas de oro
{
int colorfondo;
  if(paisaje[(y-16-(y%16))/16][(x-16-(x%16))/16]==35)  //moneda arriba izquierda
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-16-(y%16))/16][(x-16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-16-(y%16))/16][(x-16-(x%16))/16]=colorfondo;
    bloque(x-16-(x%16),y-16-(y%16),colorfondo);
    }
  if(paisaje[(y-16-(y%16))/16][(x-(x%16))/16]==35)  //moneda arriba centro
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-16-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-16-(y%16))/16][(x-(x%16))/16]=colorfondo;
    bloque(x-(x%16),y-16-(y%16),colorfondo);
    }
  if(paisaje[(y-16-(y%16))/16][(x+16-(x%16))/16]==35)  //moneda arriba derecha
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-16-(y%16))/16][(x+16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-16-(y%16))/16][(x+16-(x%16))/16]=colorfondo;
    bloque(x+16-(x%16),y-16-(y%16),colorfondo);
    }
  if(paisaje[(y-(y%16))/16][(x-16-(x%16))/16]==35)  //moneda centro izquierda
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-(y%16))/16][(x-16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-(y%16))/16][(x-16-(x%16))/16]=colorfondo;
    bloque(x-16-(x%16),y-(y%16),colorfondo);
    }
  if(paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==35)  //moneda centro derecha
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-(y%16))/16][(x+16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-(y%16))/16][(x+16-(x%16))/16]=colorfondo;
    bloque(x+16-(x%16),y-(y%16),colorfondo);
    }
  if(paisaje[(y+16-(y%16))/16][(x-16-(x%16))/16]==35)  //moneda abajo izquierda
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y+16-(y%16))/16][(x-16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y+16-(y%16))/16][(x-16-(x%16))/16]=colorfondo;
    bloque(x-16-(x%16),y+16-(y%16),colorfondo);
    }
  if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==35)  //moneda abajo centro
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y+16-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y+16-(y%16))/16][(x-(x%16))/16]=colorfondo;
    bloque(x-(x%16),y+16-(y%16),colorfondo);
    }
  if(paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==35)  //moneda abajo derecha
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y+16-(y%16))/16][(x+16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]=colorfondo;
    bloque(x+16-(x%16),y+16-(y%16),colorfondo);
    }
}


void bloque_moneda4()  //monedas de platino
{
int colorfondo;
  if(paisaje[(y-16-(y%16))/16][(x-16-(x%16))/16]==34)  //moneda arriba izquierda
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-16-(y%16))/16][(x-16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-16-(y%16))/16][(x-16-(x%16))/16]=colorfondo;
    bloque(x-16-(x%16),y-16-(y%16),colorfondo);
    }
  if(paisaje[(y-16-(y%16))/16][(x-(x%16))/16]==34)  //moneda arriba centro
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-16-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-16-(y%16))/16][(x-(x%16))/16]=colorfondo;
    bloque(x-(x%16),y-16-(y%16),colorfondo);
    }
  if(paisaje[(y-16-(y%16))/16][(x+16-(x%16))/16]==34)  //moneda arriba derecha
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-16-(y%16))/16][(x+16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-16-(y%16))/16][(x+16-(x%16))/16]=colorfondo;
    bloque(x+16-(x%16),y-16-(y%16),colorfondo);
    }
  if(paisaje[(y-(y%16))/16][(x-16-(x%16))/16]==34)  //moneda centro izquierda
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-(y%16))/16][(x-16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-(y%16))/16][(x-16-(x%16))/16]=colorfondo;
    bloque(x-16-(x%16),y-(y%16),colorfondo);
    }
  if(paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==34)  //moneda centro derecha
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y-(y%16))/16][(x+16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y-(y%16))/16][(x+16-(x%16))/16]=colorfondo;
    bloque(x+16-(x%16),y-(y%16),colorfondo);
    }
  if(paisaje[(y+16-(y%16))/16][(x-16-(x%16))/16]==34)  //moneda abajo izquierda
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y+16-(y%16))/16][(x-16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y+16-(y%16))/16][(x-16-(x%16))/16]=colorfondo;
    bloque(x-16-(x%16),y+16-(y%16),colorfondo);
    }
  if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==34)  //moneda abajo centro
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y+16-(y%16))/16][(x-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y+16-(y%16))/16][(x-(x%16))/16]=colorfondo;
    bloque(x-(x%16),y+16-(y%16),colorfondo);
    }
  if(paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==34)  //moneda abajo derecha
    {
    monedas++;
    puntos=puntos+10;
    colorfondo=colorcielo[(y+16-(y%16))/16][(x+16-(x%16))/16]+64;  //los colores en paleta son de 0-15, y en bloques de 64-79
    paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]=colorfondo;
    bloque(x+16-(x%16),y+16-(y%16),colorfondo);
    }
}


void bloque_nota0()  //nota0
{
  if((x%16)!=0)
    {
    if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==40 || paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==40)  //rebote por arriba
      {
      vy=-6;
      if(tecla[KEY_CUR_ARRIBA])
        {
        if(saltar==1)
          {
          saltar=0;
          vy=-10.0;
          }
        }
      }
    }
  else
  {
    if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==40)  //rebote por arriba
      {
      vy=-6;
      if(tecla[KEY_CUR_ARRIBA])
        {
        if(saltar==1)
          {
          saltar=0;
          vy=-10.0;
          }
        }
      }
  }
  if((x%16)!=0)  //dar chance a equivocarse por un bloque
    {
    if(paisaje[(y+32-(y%16))/16][(x-(x%16))/16]==40 || paisaje[(y+32-(y%16))/16][(x+16-(x%16))/16]==40)
      {
      if(vy<=0)
	{
        if(tecla[KEY_CUR_ARRIBA])
          {
          if(saltar==1)
            {
            saltar=0;
            vy=-10.0;
            }
          }
        }
      }
    }
  else
  {
    if(paisaje[(y+32-(y%16))/16][(x-(x%16))/16]==40)
      {
      if(vy<=0)
        {
        if(tecla[KEY_CUR_ARRIBA])
          {
          if(saltar==1)
            {
            saltar=0;
            vy=-10.0;
            }
          }
        }
      }
  }
  if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==40)  //rebote por abajo
    {
    y=y-(y%16);
    vy=-vy+4.0;
    }
  else if((paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==40) && x%16!=0)
    {
    y=y-(y%16);
    vy=-vy+4.0;
    }
  if(paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==40) //rebote derecho de nota0
    {
    vx=-vx-4.0;
    x=x-(x%16);
    }
  else if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==40) //rebote izquierdo de nota 0
    {
    vx=-vx+4.0;
    x=x+16-(x%16);
    }
}


void bloque_saltar()  //bloque para saltar muy alto
{
  if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==100 || paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==100)  //saltar
    {
    vy=vy-8.0;
    }
}


void cielo_abajo()  //flujo de aire hacia abajo
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==53)
  {
  vy=vy+1.0;
  if(tecla[KEY_CUR_ARRIBA])  //control de vuelo en el aire
    {
    vy=vy-0.25;
    }
  if(tecla[KEY_CUR_ABAJO])  //control de vuelo en el aire
    {
    vy=vy+0.25;
    }
  }
}


void cielo_arriba()  //flujo de aire hacia arriba
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==54)
  {
  vy=vy-1.0;
  if(tecla[KEY_CUR_ARRIBA])  //control de vuelo en el aire
    {
    vy=vy-0.25;
    }
  if(tecla[KEY_CUR_ABAJO])  //control de vuelo en el aire
    {
    vy=vy+0.25;
    }
  }
}


void cielo_izquierda()  //flujo de aire hacia la izquierda
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==55)
  {
  vx=vx-1.0;
  if(tecla[KEY_CUR_ARRIBA])  //control de vuelo en el aire
    {
    vy=vy-0.25;
    }
  if(tecla[KEY_CUR_ABAJO])  //control de vuelo en el aire
    {
    vy=vy+0.25;
    }
  }
}


void cielo_derecha()  //flujo de aire hacia la derecha
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==56)
  {
  vx=vx+1.0;
  if(tecla[KEY_CUR_ARRIBA])  //control de vuelo en el aire
    {
    vy=vy-0.25;
    }
  if(tecla[KEY_CUR_ABAJO])  //control de vuelo en el aire
    {
    vy=vy+0.25;
    }
  }
}


void agua()
{
nadando=0;
}


void agua_abajo()  //flujo de agua hacia abajo
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==57)  //verificando si el centro del patito esta en el agua
  {
  nadando=1;
  vy=vy+0.5;
  }
if(nadando==1)
  {
  if(paisaje[(y-(y%16))/16][((x+8)-((x+8)%16))/16]==57)  //verificar que los bloques de arriba al centro sean agua
    {
    if(tecla[KEY_CUR_ARRIBA])  //saltar 72
      {
      vy=vy-0.375;
      }
    }
  if(paisaje[(y+16-(y%16))/16][((x+8)-((x+8)%16))/16]==57)  //verificar que los bloques de abajo al centro sean agua
    {
    if(tecla[KEY_CUR_ABAJO])  //undirse en el agua
      {
      if(estado>=3)
        {
        vy=vy+0.25;
        }
      }
    }
  }
}


void agua_arriba()  //flujo de agua hacia arriba
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==58)  //verificando si el centro del patito esta en el agua
  {
  nadando=1;
  vy=vy-0.5;
  }
if(nadando==1)
  {
  if(paisaje[(y-(y%16))/16][((x+8)-((x+8)%16))/16]==58)  //verificar que los bloques de arriba al centro sean agua
    {
    if(tecla[KEY_CUR_ARRIBA])  //saltar 72
      {
      vy=vy-0.375;
      }
    }
  if(paisaje[(y+16-(y%16))/16][((x+8)-((x+8)%16))/16]==58)  //verificar que los bloques de abajo al centro sean agua
    {
    if(tecla[KEY_CUR_ABAJO])  //undirse en el agua
      {
      if(estado>=3)
        {
        vy=vy+0.25;
        }
      }
    }
  }
}


void agua_izquierda()  //flujo de agua hacia izquierda
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==59)  //verificando si el centro del patito esta en el agua
  {
  nadando=1;
  vx=vx-0.5;
  }
if(nadando==1)
  {
  if(paisaje[(y-(y%16))/16][((x+8)-((x+8)%16))/16]==59)  //verificar que los bloques de arriba al centro sean agua
    {
    if(tecla[KEY_CUR_ARRIBA])  //saltar 72
      {
      vy=vy-0.375;
      }
    }
  if(paisaje[(y+16-(y%16))/16][((x+8)-((x+8)%16))/16]==59)  //verificar que los bloques de abajo al centro sean agua
    {
    if(tecla[KEY_CUR_ABAJO])  //undirse en el agua
      {
      if(estado>=3)
        {
        vy=vy+0.25;
        }
      }
    }
  }
}


void agua_derecha()  //flujo de agua hacia derecha
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==60)  //verificando si el centro del patito esta en el agua
  {
  nadando=1;
  vx=vx+0.5;
  }
if(nadando==1)
  {
  if(paisaje[(y-(y%16))/16][((x+8)-((x+8)%16))/16]==60)  //verificar que los bloques de arriba al centro sean agua
    {
    if(tecla[KEY_CUR_ARRIBA])  //saltar 72
      {
      vy=vy-0.375;
      }
    }
  if(paisaje[(y+16-(y%16))/16][((x+8)-((x+8)%16))/16]==60)  //verificar que los bloques de abajo al centro sean agua
    {
    if(tecla[KEY_CUR_ABAJO])  //undirse en el agua
      {
      if(estado>=3)
        {
        vy=vy+0.25;
        }
      }
    }
  }
}


void bloque_agua()
{
if(paisaje[((y+8)-((y+8)%16))/16][((x+8)-((x+8)%16))/16]==73)  //verificando si el centro del patito esta en el agua
  {
  nadando=1;
  }
if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==50 && paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]==50)  //para saltar sobre el agua
  {
  if(tecla[KEY_CUR_ARRIBA])  //saltar 72
    {
    if(saltar==1)
      {
      saltar=0;
      vy=-10.0;
      }
    }
  }
if(nadando==1)
  {
  if(vy>2.0)  //aumentar viscocidad segun velocidad
    {
    if(vy>=4)
      {
      vy=vy-0.5;
      }
    vy=vy-0.25;
    }
  else if(vy<-2.0)
    {
    if(vy<=-4.0)
      {
      vy=vy+0.5;
      }
    vy=vy+0.25;
    }
  if(vx>2.0)
    {
    if(vx>=4.0)
      {
      vx=vx-0.5;
      }
    vx=vx-0.25;
    }
  else if(vx<-2.0)
    {
    if(vx<=-4.0)
      {
      vx=vx+0.5;
      }
    vx=vx+0.25;
    }
  if(paisaje[(y-(y%16))/16][((x+8)-((x+8)%16))/16]==73)  //verificar que los bloques de arriba al centro sean agua
    {
    if(tecla[KEY_CUR_ARRIBA])  //saltar 72
      {
      //vy=-2.0;
      vy=vy-0.375;
      }
    }
  if(paisaje[(y+16-(y%16))/16][((x+8)-((x+8)%16))/16]==73)  //verificar que los bloques de abajo al centro sean agua
    {
    if(tecla[KEY_CUR_ABAJO])  //undirse en el agua
      {
      if(estado>=3)
        {
        //vy=2.0;
        vy=vy+0.25;
        }
      }
    }
  }
}


void eliNITRO(int i, int j)
{
paisaje[j][i]=colorcielo[j][i]+64;
bloque(i*16,j*16,colorcielo[j][i]+64);
c_explosion_chica(i*16,j*16);  //nota: coordenadas en pixeles,    prefiero explosion grande
}


void NITRO_mata()  //no toques la nitroglicerina
{
if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==48)
  {
  //no actualizo escenario, ya que la explosion hace lo suyo
  eliNITRO((x-(x%16))/16,(y-(y%16))/16);
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
else if(paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==48 && x%16!=0)
  {
  eliNITRO((x+16-(x%16))/16,(y-(y%16))/16);
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
else if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==48 && x%16!=0)
  {
  eliNITRO((x-(x%16))/16,(y+16-(y%16))/16);
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
else if(paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==48 && x%16!=0)
  {
  eliNITRO((x+16-(x%16))/16,(y+16-(y%16))/16);
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
}


void fuego4_mata()  //no toques el fuego
{
if(paisaje[(y-(y%16))/16][(x-(x%16))/16]==52)
  {
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
else if(paisaje[(y-(y%16))/16][(x+16-(x%16))/16]==52 && x%16!=0)
  {
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
else if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==52 && x%16!=0)
  {
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
else if(paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==52 && x%16!=0)
  {
  if(invensible==0)
    {
    estado--;
    invensible=tiempo_invensible;
    t_huevo=tiempo-4;  //solo es necesario si su estado es 0
    }
  }
}


void tocar_champinon()  //tocar champiñon
{
int i,j;
  for(i=0;i<4;i++)
    {
    if(nchamp[i]!=0)
      {
      if(x<=champx[i]+16 && x>=champx[i]-16)
        {
        if(y<=champy[i]+16 && y>=champy[i]-16)
          {
          switch(nchamp[i])
            {
            case -5:
              elichamp(i);
              vidas--;
              estado--;
              puntos=puntos-5000;
            break;
            case -4:
              elichamp(i);
              vidas++;
              puntos=puntos+100;
            break;
            case -1:
              elichamp(i);
              estado++;
              puntos=puntos+100;
            break;
            case 1:
              elichamp(i);
              estado++;
              puntos=puntos+100;
            break;
            case 4:
	      elichamp(i);
              vidas++;
              puntos=puntos+100;
            break;
            case 5:
              elichamp(i);
              vidas--;
              estado--;
              puntos=puntos-5000;
            break;
            }
          }
        }
      }
    }
}


void mina_mata()    //mina mata
{
int i;
for(i=0;i<8;i++)
  {
  if(nmina[i]!=0)
    {
    if(x<minax[i]+16 && x>=minax[i]-16)  //si la posicion concuerda en x
      {
      if(y<minay[i]+16 && y>=minay[i]-16)  //si la posicion concuerda en y
        {
        if(invensible==0)
          {
          c_explosion_chica(minax[i],minay[i]);  //nota: coordenadas en pixeles
          elimina(i);
          estado--;
          invensible=tiempo_invensible;
          t_huevo=tiempo-4;  //solo es necesario si su estado es 0
          }
        }
      }
    }
  }
}


void bloque_cuadrado0()  //puedes pararte sobre el bloque pero no golpearlo por abajo  (pesado)
{
  if((x%16)!=0)
    {
    if((paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==41 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==42 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==43) && (paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==41 || paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==42 || paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==43))  //gravedad verificando si el bloque de abajo a la izquierda o el bloque de abajo a la derecha es bloque cuadrado
      {
      if(vy>0)  //determinar si esta cayendo o saltando
        {
        vy=0.0;
        y=y-(y%16);
        }
      }
    }
  else
    {
    if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==41 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==42 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==43)  //gravedad verificando si el bloque de abajo a la izquierda es bloque cuadrado
      {
      if(vy>0)  //determinar si esta cayendo o saltando
        {
        vy=0.0;
        y=y-(y%16);
        }
      }
    }
  if(tecla[KEY_CUR_ARRIBA])  //saltar
    {
    if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==42 || (paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==42 && x%16!=0))  //bloque cuadrado
      {
      if(vy>=0.0)
        {
        if(saltar==1)
          {
          saltar=0;
          vy=-8.0;
          }
        }
      }
    }
}


void bloque_cuadrado1()  //puedes pararte sobre el bloque pero no golpearlo por abajo  (pesado)
{
  if((x%16)!=0)
    {
    if((paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==44 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==45 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==46) && (paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==44 || paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==45 || paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==46))  //gravedad verificando si el bloque de abajo a la izquierda o el bloque de abajo a la derecha es bloque cuadrado
      {
      if(vy>0)  //determinar si esta cayendo o saltando
        {
        vy=0.0;
        y=y-(y%16);
        }
      }
    }
  else
    {
    if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==44 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==45 || paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==46)  //gravedad verificando si el bloque de abajo a la izquierda es bloque cuadrado
      {
      if(vy>0)  //determinar si esta cayendo o saltando
        {
        vy=0.0;
	y=y-(y%16);
        }
      }
    }
  if(tecla[KEY_CUR_ARRIBA])  //saltar
    {
    if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]==45 || (paisaje[(y+16-(y%16))/16][(x+16-(x%16))/16]==45 && x%16!=0))  //bloque cuadrado
      {
      if(vy>=0.0)
        {
        if(saltar==1)
          {
          saltar=0;
          vy=-8.0;
          }
        }
      }
    }
}


void panel()
{
  setcolor(15);
  line(0,416,639,416);
  line(0,416,0,479);
  line(0,479,639,479);
  line(639,416,639,479);
}


void panelnumerico()
{
  int n;
#ifdef MSDOS
  gotoxy(4,28);
  printf("Nivel %d-%d ",nivel,escena);
  gotoxy(4,29);
  printf("Vidas %d   ",vidas);
  gotoxy(15,28);
  for(n=0;n<volar;n++)
    {
    printf("ß");
    }
  for(n=volar;n<22;n++)
    {
    printf(" ");
    }
  gotoxy(15,29);
  printf("Puntos %li  ",puntos);
  gotoxy(40,28);
  printf("Monedas %d   ",monedas);
  gotoxy(40,29);
  printf("Tiempo %d  ",tiempo);
#else
  static char aux[80];
  setfillstyle(1,0);
  bar(104,432,488,456); //borrar letras antiguas
  sprintf(aux,"Nivel %d-%d ",nivel,escena);
  texto(13*8,27*16,0,15,aux);
  sprintf(aux,"Vidas %d   ",vidas);
  texto(13*8,28*16,0,15,aux);
  //sprintf(aux,"ß");
  sprintf(aux,"ß");
  for(n=0;n<volar;n++)
    {
    texto((24+n)*8,27*16,2,10,aux);
    }
  //sprintf(aux," ");
  sprintf(aux,"ß");
  for(n=volar;n<22;n++)
    {
    texto((24+n)*8,27*16,4,13,aux);
    }
  sprintf(aux,"Puntos %li  ",puntos);
  texto(24*8,28*16,0,15,aux);
  sprintf(aux,"Monedas %d   ",monedas);
  texto(49*8,27*16,0,15,aux);
  sprintf(aux,"Tiempo %d  ",tiempo);
  texto(49*8,28*16,0,15,aux);
#endif
}


void verestado()  //verificar el estado del patito y dibujarlo segun el estado
{
int i,j,subiendo_o_bajando=0;
  switch(estado)
    {
    case 0:  //perdiste una vida
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(huevo[j][i]!=22)
            {
            putpixel(x+i,y+j,huevo[j][i]);
            }
          }
        }
      if(t_huevo==tiempo)  //esperar 4 segundos antes de terminar el nivel
        {
        estado++;
        vidas--;
        ciclo=1;
        jugar=0;
        }
      //musiquita y pantalla de perder
    break;
    case 1:
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(patito0[j][i]!=22)
            {
            putpixel(x+i,y+j,patito0[j][i]);
            }
          }
        }
    break;
    case 2:
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(pato0[j][i]!=22)
            {
            putpixel(x+i,y+j,pato0[j][i]);
            }
          }
        }
    break;
    case 3:
      if(nadando==1)
        {
        if((tecla[KEY_CUR_ARRIBA]==1 || tecla[KEY_CUR_ABAJO]==1) && tecla[KEY_CUR_ATRAS]==0 && tecla[KEY_CUR_ADELANTE]==0)  //si se presiona unicamente subir o bajar
          {
          subiendo_o_bajando=1;
          if((y%12)<=3)  //animar el pinguino
            {
            pasoy=0;
            }
          else if ((y%12)>=4 && (y%12)<=7)
            {
            pasoy=1;
            }
          else if((y%12)>=8)
            {
            pasoy=2;
            }
          }
        else
          {
          pasoy=0;
          }
        }
      if(vx==0)
        {
        pasox=1;
        }
      else
        {
        if((x%8)<=3)  //animar el pinguino
          {
          pasox=1;
          }
        else if ((x%8)>=4)
	    {
          pasox=-1;
          }
        }
      if(subiendo_o_bajando==0)
        {
        if(dirx>0)
          {
          if(pasox==1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguino0[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguino0[j][i]);
                  }
                }
              }
            }
          if(pasox==-1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguino1[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguino1[j][i]);
                  }
                }
              }
            }
          }
	if(dirx<0)
          {
          if(pasox==1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguino2[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguino2[j][i]);
                  }
                }
              }
            }
          if(pasox==-1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguino3[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguino3[j][i]);
                  }
                }
              }
            }
          }
        }
      else
        {
        if(nadando==1)
          {
          if(diry<0)
	        {
            if(pasoy==0)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguino_subiendo0[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguino_subiendo0[j][i]);
                    }
                  }
                }
              }
            if(pasoy==1)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguino_subiendo1[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguino_subiendo1[j][i]);
                    }
                  }
                }
              }
            if(pasoy==2)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguino_subiendo2[j][i]!=22)
                    {
		        putpixel(x+i,y+j,pinguino_subiendo2[j][i]);
                    }
                  }
                }
              }
            }
          if(diry>0)
            {
            if(pasoy==0)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguino_bajando0[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguino_bajando0[j][i]);
                    }
                  }
                }
              }
            if(pasoy==1)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguino_bajando1[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguino_bajando1[j][i]);
                    }
                  }
                }
              }
            if(pasoy==2)
	          {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguino_bajando2[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguino_bajando2[j][i]);
                    }
                  }
                }
              }
            }
          }
        }
    break;
    case 4:
      if(nadando==1)
        {
        if((tecla[KEY_CUR_ARRIBA]==1 || tecla[KEY_CUR_ABAJO]==1) && tecla[KEY_CUR_ATRAS]==0 && tecla[KEY_CUR_ADELANTE]==0)  //si se presiona unicamente subir o bajar
          {
          subiendo_o_bajando=1;
          if((y%12)<=3)
            {
            pasoy=0;
            }
          else if ((y%12)>=4 && (y%12)<=7)
            {
            pasoy=1;
            }
          else if((y%12)>=8)
            {
            pasoy=2;
            }
          }
	else
          {
          pasoy=0;
          }
        }
      if(vx==0)
        {
        pasox=1;
        }
      else
        {
        if((x%8)<=3)
          {
          pasox=1;
          }
        else if ((x%8)>=4)
          {
          pasox=-1;
          }
        }
      if(subiendo_o_bajando==0)
        {
        if(dirx>0)
          {
          if(pasox==1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguinorojo0[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguinorojo0[j][i]);
                  }
                }
	      }
            }
          if(pasox==-1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguinorojo1[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguinorojo1[j][i]);
                  }
                }
              }
            }
          }
        if(dirx<0)
          {
          if(pasox==1)
            {
            for(j=0;j<16;j++)
              {
              for(i=0;i<16;i++)
                {
                if(pinguinorojo2[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguinorojo2[j][i]);
                  }
                }
              }
            }
          if(pasox==-1)
            {
            for(j=0;j<16;j++)
              {
	      for(i=0;i<16;i++)
                {
                if(pinguinorojo3[j][i]!=22)
                  {
                  putpixel(x+i,y+j,pinguinorojo3[j][i]);
                  }
                }
              }
            }
          }
        }
      else
        {
        if(nadando==1)
          {
          if(diry<0)
            {
            if(pasoy==0)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguinorojo_subiendo0[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguinorojo_subiendo0[j][i]);
                    }
                  }
                }
              }
            if(pasoy==1)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
		  {
                  if(pinguinorojo_subiendo1[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguinorojo_subiendo1[j][i]);
                    }
                  }
                }
              }
            if(pasoy==2)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguinorojo_subiendo2[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguinorojo_subiendo2[j][i]);
                    }
                  }
                }
              }
            }
          if(diry>0)
            {
            if(pasoy==0)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguinorojo_bajando0[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguinorojo_bajando0[j][i]);
                    }
                  }
	            }
              }
            if(pasoy==1)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguinorojo_bajando1[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguinorojo_bajando1[j][i]);
                    }
                  }
                }
              }
            if(pasoy==2)
              {
              for(j=0;j<16;j++)
                {
                for(i=0;i<16;i++)
                  {
                  if(pinguinorojo_bajando2[j][i]!=22)
                    {
                    putpixel(x+i,y+j,pinguinorojo_bajando2[j][i]);
                    }
                  }
                }
              }
            }
          }
        }
    break;
    default:
    vidas++;
    estado=4;
    break;
    }
  if(debug==1)
    {
    capturar_animacion();  //permite que se capture animacion para luego ser reproducida
    }
}


void ayuda()
{
setfillstyle(1,0);  //negro
bar(32,8,624,336);
gotoxy(24,2);
printf("AYUDA DE SUPER PATITO BROS");
gotoxy(8,5);
printf("Û Uso del teclado para jugar:");
gotoxy(8,7);
printf("- Usa las flechas en tu teclado para desplazarte");
gotoxy(8,8);
printf("la flecha de ARRIBA es para saltar y ESPACIO para volar un poco");
gotoxy(8,9);
printf("- F1 es para abrir esta pagina de ayuda");
gotoxy(8,10);
printf("- ENTER es para pausar y despausar el juego");
gotoxy(8,11);
printf("- CONTROL es para disparar estando en forma pinguino rojo");
gotoxy(8,12);
printf("- Alt+F4 es para salir del juego sin ningun aviso");
gotoxy(8,15);
printf("Û Como se juega?:");
gotoxy(8,17);
printf("- Avanza siempre hacia la derecha pasando los obstaculos, al llegar");
gotoxy(8,18);
printf("a la orilla derecha de la pantalla pasaras a la siguente escena");
gotoxy(20,21);
printf("PRESIONA CUALQUIER TECLA PARA CONTINUAR");
tomarletra();  //igual que el getch()
fondo();
panel();
segundo_invalido=1;
}


void pausa()  //pausar si se presiona la tecla enter
{
int i,j;
for(j=0;j<16;j++)
  {
  for(i=0;i<16;i++)
    {
    putpixel(i+304,j+208,pausa0[j][i]);
    }
  }
for(j=0;j<16;j++)
  {
  for(i=0;i<16;i++)
    {
    putpixel(i+320,j+208,pausa1[j][i]);
    }
  }
while(tecla[KEY_ENTER])  //esperar a que suelte la tecla enter cuando a iniciado la pausa
  {
IntTeclado();
  }
while(!tecla[KEY_ENTER])  //esperar a que vuelva a apretar enter para quitar la pausa
  {
IntTeclado();
  }
while(tecla[KEY_ENTER])  //esperar a que suelte la tecla enter para quitar la pausa
  {
IntTeclado();
  }
//  304/16=19    320/16=20
//  208/16=13
bloque(304,208,paisaje[13][19]);
bloque(320,208,paisaje[13][20]);
segundo_invalido=1;
}


void segundos()
{
sec++;
if(sec%CPS==0)  //realizar un conteo del tiempo del juego
  {
  sec=0;
  tiempo--;
  if(tiempo==0)
    {
    estado=0;
    }
  if(tiempo%2==0)  //para volar
    {
    volar++;
    if(volar>22)
      {
      volar=22;
      }
    }
  }
}


void champifuera()
{
int n;
for(n=0;n<4;n++)
  {
  if(nchamp[n]!=0)
    {
    if(champx[n]>=624) //si llega a la orilla derecha eliminar champiñon
      {
      elichamp(n);
      }
    else if(champx[n]<=-4) //si llega a la orilla izquierda eliminar champiñon
      {
      elichamp(n);
      }
    else if(champy[n]>=464) //caida
      {
      elichamp(n);
      }
    }
  }
}


void r_disparo()  //resetear disparos
{
int i;
for(i=0;i<4;i++)
  {
  ndisparo[i]=0;
  disparox[i]=-200;
  disparoy[i]=-200;
  disparoo[i]=-200;
  disparop[i]=-200;
  disparovy[i]=0.0;
  disparovx[i]=0.0;
  }
}


void c_disparo()
{
int n;
if(tdisparo==0)  //determina si el pinguino está listo para disparar (ver movdisparo())
  {
  tdisparo=1;
  for(n=0;n<4;n++)
    {
    if(ndisparo[n]==0)
      {
      if(dirx>0)
        {
        ndisparo[n]=1;
        disparox[n]=x;
        disparoy[n]=y;
        disparoo[n]=x;
        disparop[n]=y;
        }
      if(dirx<0)
        {
        ndisparo[n]=-1;
        disparox[n]=x;
        disparoy[n]=y;
        disparoo[n]=x;
        disparop[n]=y;
        }
      if(vy<0)
        {
        disparovy[n]=-4.0;
        }
      else
        {
        disparovy[n]=+4.0;
        }
      n=4;
      }
    }
  }
}


void elidisparo(int i)
{
//c_golpe(disparox[i],disparoy[i]);
//borrando variables
ndisparo[i]=0;
//borrando rastro del dibujo, redibujando fondo
if((disparoo[i]%16)!=0)  // comprobar que bloques necesitan actualizarse
  {
  bloque(disparoo[i]-(disparoo[i]%16),disparop[i]-(disparop[i]%16),paisaje[(disparop[i]-(disparop[i]%16))/16][(disparoo[i]-(disparoo[i]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
  bloque(disparoo[i]-(disparoo[i]%16)+16,disparop[i]-(disparop[i]%16),paisaje[(disparop[i]-(disparop[i]%16))/16][(disparoo[i]+16-(disparoo[i]%16))/16]);  //actualizar bloque que esta arriba a la derecha
  if((disparop[i]%16)!=0)
    {
    bloque(disparoo[i]-(disparoo[i]%16),disparop[i]-(disparop[i]%16)+16,paisaje[(disparop[i]+16-(disparop[i]%16))/16][(disparoo[i]-(disparoo[i]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
    bloque(disparoo[i]-(disparoo[i]%16)+16,disparop[i]-(disparop[i]%16)+16,paisaje[(disparop[i]+16-(disparop[i]%16))/16][(disparoo[i]+16-(disparoo[i]%16))/16]);  //actualizar bloque que esta abajo a la derecha
    }
  }
else if((disparop[i]%16)!=0)
  {
  bloque(disparoo[i]-(disparoo[i]%16),disparop[i]-(disparop[i]%16),paisaje[(disparop[i]-(disparop[i]%16))/16][(disparoo[i]-(disparoo[i]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
  bloque(disparoo[i]-(disparoo[i]%16),disparop[i]-(disparop[i]%16)+16,paisaje[(disparop[i]+16-(disparop[i]%16))/16][(disparoo[i]-(disparoo[i]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
  }
else
  {
  bloque(disparoo[i],disparop[i],paisaje[disparop[i]/16][disparoo[i]/16]);  //actualizar bloque que esta en su posicion
  }
}


void movdisparo()
{
int n;
if(sec%8==0)  // usado en cdisparo para permitir solo 4 disparos por segundo
  {
  tdisparo=0;
  }
for(n=0;n<4;n++)
  {
  if(ndisparo[n]!=0)
    {
    if(ndisparo[n]==1)  //determinar sentido
      {
      disparox[n]=disparox[n]+8;
      }
    if(ndisparo[n]==-1)  //determinar sentido
      {
      disparox[n]=disparox[n]-8;
      }
    if((disparox[n]%16)!=0)
      {
      if(paisaje[(disparoy[n]+16-(disparoy[n]%16))/16][(disparox[n]-(disparox[n]%16))/16]>=32 && paisaje[(disparoy[n]+16-(disparoy[n]%16))/16][(disparox[n]+16-(disparox[n]%16))/16]>=32)  //gravedad verificando si el bloque de abajo a la izquierda o el bloque de abajo a la derecha es aire
        {
        disparovy[n]=disparovy[n]+0.5;
        }
      else
        {
        disparovy[n]=-4.0;
        disparoy[n]=disparoy[n]-(disparoy[n]%16);
        }
      }
    else
      {
      if(paisaje[(disparoy[n]+16-(disparoy[n]%16))/16][(disparox[n]-(disparox[n]%16))/16]>=32)  //gravedad verificando si el bloque de abajo a la izquierda es aire
        {
        disparovy[n]=disparovy[n]+0.5;
        }
      else
        {
        disparovy[n]=-4.0;
        disparoy[n]=disparoy[n]-(disparoy[n]%16);
        }
      }
    if(paisaje[(disparoy[n]-(disparoy[n]%16))/16][(disparox[n]+16-(disparox[n]%16))/16]<32) //eliminar disparo al chocar con bloque derecho
      {
      elidisparo(n);
      c_golpe(disparox[n],disparoy[n]);
      }
    else if(paisaje[(disparoy[n]-(disparoy[n]%16))/16][(disparox[n]-(disparox[n]%16))/16]<32) //eliminar disparo al chocar con bloque izquierdo
      {
      elidisparo(n);
      c_golpe(disparox[n],disparoy[n]);
      }
    disparoy[n]=disparoy[n]+disparovy[n];
    disparox[n]=disparox[n]+disparovx[n];
    }
  }
}


void dibdisparo()
{
int n,i,j;
for(n=0;n<4;n++)
  {
  if(ndisparo[n]!=0)
    {
    if(sec%4==0)
      {
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(disparo0[j][i]!=22)
            {
            putpixel(disparox[n]+i,disparoy[n]+j,disparo0[j][i]);
            }
          }
        }
      }
    if(sec%4==1)
      {
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(disparo1[j][i]!=22)
            {
            putpixel(disparox[n]+i,disparoy[n]+j,disparo1[j][i]);
            }
          }
        }
      }
    if(sec%4==2)
      {
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(disparo2[j][i]!=22)
            {
            putpixel(disparox[n]+i,disparoy[n]+j,disparo2[j][i]);
            }
          }
        }
      }
    if(sec%4==3)
      {
      for(j=0;j<16;j++)
        {
        for(i=0;i<16;i++)
          {
          if(disparo3[j][i]!=22)
            {
            putpixel(disparox[n]+i,disparoy[n]+j,disparo3[j][i]);
            }
	  }
        }
      }
    }
  }
}


void refdisparo()
{
int n;
for(n=0;n<4;n++)
  {
  if(ndisparo[n]!=0)
    {
    if((disparoo[n]%16)!=0)  // comprobar que bloques necesitan actualizarse
      {
      bloque(disparoo[n]-(disparoo[n]%16),disparop[n]-(disparop[n]%16),paisaje[(disparop[n]-(disparop[n]%16))/16][(disparoo[n]-(disparoo[n]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
      bloque(disparoo[n]-(disparoo[n]%16)+16,disparop[n]-(disparop[n]%16),paisaje[(disparop[n]-(disparop[n]%16))/16][(disparoo[n]+16-(disparoo[n]%16))/16]);  //actualizar bloque que esta arriba a la derecha
      if((disparop[n]%16)!=0)
        {
        bloque(disparoo[n]-(disparoo[n]%16),disparop[n]-(disparop[n]%16)+16,paisaje[(disparop[n]+16-(disparop[n]%16))/16][(disparoo[n]-(disparoo[n]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
        bloque(disparoo[n]-(disparoo[n]%16)+16,disparop[n]-(disparop[n]%16)+16,paisaje[(disparop[n]+16-(disparop[n]%16))/16][(disparoo[n]+16-(disparoo[n]%16))/16]);  //actualizar bloque que esta abajo a la derecha
        }
      }
    else if((disparop[n]%16)!=0)
      {
      bloque(disparoo[n]-(disparoo[n]%16),disparop[n]-(disparop[n]%16),paisaje[(disparop[n]-(disparop[n]%16))/16][(disparoo[n]-(disparoo[n]%16))/16]);  //actualizar bloque que esta arriba a la izquierda
      bloque(disparoo[n]-(disparoo[n]%16),disparop[n]-(disparop[n]%16)+16,paisaje[(disparop[n]+16-(disparop[n]%16))/16][(disparoo[n]-(disparoo[n]%16))/16]);  //actualizar bloque que esta abajo a la izquierda
      }
    else
      {
      bloque(disparoo[n],disparop[n],paisaje[disparop[n]/16][disparoo[n]/16]);  //actualizar bloque que esta arriba a la izquierda, el bloque que esta en su posicion
      }
    }
  }
}


void disparofuera()
{
int n;
for(n=0;n<4;n++)
  {
  if(ndisparo[n]!=0)
    {
    if(disparox[n]>=624) //si llega a la orilla derecha eliminar disparo
      {
      elidisparo(n);
      }
    else if(disparox[n]<=-4) //si llega a la orilla izquierda eliminar disparo
      {
      elidisparo(n);
      }
    else if(disparoy[n]>=464) //caida
      {
      elidisparo(n);
      }
    }
  }
}


void disparo_mata()  //disparo que mata patos y mas
{
int n,m;
for(n=0;n<4;n++)  //buscar disparos activos
  {
  if(ndisparo[n]!=0)
    {
    for(m=0;m<8;m++)  //patos
      {
      if(npato[m]!=0)
        {
        if(disparox[n]<=patox[m]+16 && disparox[n]>=patox[m]-16)
          {
          if(disparoy[n]<=patoy[m]+16 && disparoy[n]>=patoy[m]-16)
            {
            elidisparo(n);
            elipato(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }
///////////////////////////////////////////
/*
    for(m=0;m<8;m++)  //patos
      {
      if(npato[m]!=0)
        {
        if(disparox[n]-(disparox[n]%16)==patox[m]-(patox[m]%16) || disparox[n]-16-(disparox[n]%16)==patox[m]-(patox[m]%16))  //comprobar si coincide con la posicion en x
          {
          if(disparoy[n]+16-(disparoy[n]%16)==patoy[m]-(patoy[m]%16) || disparoy[n]-(disparoy[n]%16)==patoy[m]-(patoy[m]%16))  //comprobar que coincide con la posicion en y
            {
            elidisparo(n);
            elipato(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }*/
////////////////////////////////////////////
    for(m=0;m<4;m++)  //patos saltadores
      {
      if(nsalta[m]!=0)
        {
        if(disparox[n]<=saltax[m]+16 && disparox[n]>=saltax[m]-16)
          {
          if(disparoy[n]<=saltay[m]+16 && disparoy[n]>=saltay[m]-16)
            {
            elidisparo(n);
            elisalta(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }
////////////////////////////////////////////////////
/*
    for(m=0;m<4;m++)  //patos saltadores
      {
      if(nsalta[m]!=0)
        {
        if(disparox[n]-(disparox[n]%16)==saltax[m]-(saltax[m]%16) || disparox[n]-16-(disparox[n]%16)==saltax[m]-(saltax[m]%16))  //comprobar si coincide con la posicion en x
          {
          if(disparoy[n]+16-(disparoy[n]%16)==saltay[m]-(saltay[m]%16) || disparoy[n]-(disparoy[n]%16)==saltay[m]-(saltay[m]%16))  //comprobar que coincide con la posicion en y
            {
            elidisparo(n);
            elisalta(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }*/
/////////////////////////////////////////////////////
    for(m=0;m<8;m++)  //patos seguidores
      {
      if(nseguidor[m]!=0)
        {
        if(disparox[n]<=seguidorx[m]+16 && disparox[n]>=seguidorx[m]-16)
          {
          if(disparoy[n]<=seguidory[m]+16 && disparoy[n]>=seguidory[m]-16)
            {
            elidisparo(n);
            eliseguidor(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }
////////////////////////////////////////////
/*
    for(m=0;m<8;m++)  //patos seguidores
      {
      if(nseguidor[m]!=0)
        {
        if(disparox[n]-(disparox[n]%16)==seguidorx[m]-(seguidorx[m]%16) || disparox[n]-16-(disparox[n]%16)==seguidorx[m]-(seguidorx[m]%16))  //comprobar si coincide con la posicion en x
          {
          if(disparoy[n]+16-(disparoy[n]%16)==seguidory[m]-(seguidory[m]%16) || disparoy[n]-(disparoy[n]%16)==seguidory[m]-(seguidory[m]%16))  //comprobar que coincide con la posicion en y
            {
            elidisparo(n);
            eliseguidor(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }*/
///////////////////////////////////////////
    for(m=0;m<4;m++)  //patos peligrosos
      {
      if(npeligro[m]!=0)
        {
        if(disparox[n]<=peligrox[m]+16 && disparox[n]>=peligrox[m]-16)
          {
          if(disparoy[n]<=peligroy[m]+16 && disparoy[n]>=peligroy[m]-16)
            {
            elidisparo(n);
            elipeligro(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }
//////////////////////////////////////
/*
    for(m=0;m<4;m++)  //patos peligrosos
      {
      if(npeligro[m]!=0)
        {
        if(disparox[n]-(disparox[n]%16)==peligrox[m]-(peligrox[m]%16) || disparox[n]-16-(disparox[n]%16)==peligrox[m]-(peligrox[m]%16))  //comprobar si coincide con la posicion en x
          {
          if(disparoy[n]+16-(disparoy[n]%16)==peligroy[m]-(peligroy[m]%16) || disparoy[n]-(disparoy[n]%16)==peligroy[m]-(peligroy[m]%16))  //comprobar que coincide con la posicion en y
            {
            elidisparo(n);
            elipeligro(m);
            c_golpe(disparox[n],disparoy[n]);
            puntos=puntos+100;
            }
          }
        }
      }*/
///////////////////////////////////
    for(m=0;m<8;m++)  //minas
      {
      if(nmina[m]!=0)
        {
        if(disparox[n]<=minax[m]+16 && disparox[n]>=minax[m]-16)
          {
          if(disparoy[n]<=minay[m]+16 && disparoy[n]>=minay[m]-16)
            {
            elidisparo(n);
            //c_golpe(disparox[n],disparoy[n]);
            c_explosion_chica(minax[m],minay[m]);  //nota: coordenadas en pixeles
            elimina(m);
            puntos=puntos+100;
            }
          }
        }
      }
    for(m=0;m<8;m++)  //tortugas
      {
      if(ntortuga[m]!=0)
        {
        if(ntortuga[m]<=4)
          {
          if(disparox[n]<=tortugax[m]+16 && disparox[n]>=tortugax[m]-16)
            {
            if(disparoy[n]<=tortugay[m]-16 && disparoy[n]>=tortugay[m]-32)  //golpe en la cabeza
              {
              elidisparo(n);
              //elitortuga(m);
              ntortuga[m]=8;
              tortugavy[m]=-4.0;
              c_golpe(disparox[n],disparoy[n]);
              puntos=puntos+100;
              }
            if(disparoy[n]<=tortugay[m]+16 && disparoy[n]>=tortugay[m]-16)  //golpe en el cuerpo
              {
              c_golpe(disparox[n],disparoy[n]);
	        elidisparo(n);
              }
            }
          }
        else if(ntortuga[m]<8)
          {
          if(disparox[n]<=tortugax[m]+16 && disparox[n]>=tortugax[m]-16)
            {
            if(disparoy[n]<=tortugay[m]+16 && disparoy[n]>=tortugay[m]-16)
              {
              elidisparo(n);
              //elitortuga(m);
              ntortuga[m]=8;
              tortugavy[m]=-4.0;
              c_golpe(disparox[n],disparoy[n]);
              puntos=puntos+100;
              }
            }
          }
        }
      }
    if(paisaje[(disparoy[n]-(disparoy[n]%16))/16][(disparox[n]-(disparox[n]%16))/16]==48)  //detecion de solidos para la esquina izquierda superior
      {
      eliNITRO((disparox[n]-(disparox[n]%16))/16,(disparoy[n]-(disparoy[n]%16))/16);
      elidisparo(n);
      }
    if(paisaje[(disparoy[n]-(disparoy[n]%16))/16][(disparox[n]+15-((disparox[n]+15)%16))/16]==48)  //detecion de solidos para la esquina derecha superior
      {
      eliNITRO((disparox[n]+15-((disparox[n]+15)%16))/16,(disparoy[n]-(disparoy[n]%16))/16);
      elidisparo(n);
      }
    if(paisaje[(disparoy[n]+16-(disparoy[n]%16))/16][(disparox[n]-(disparox[n]%16))/16]==48)  //detecion de solidos para la esquina izquierda inferior
      {
      eliNITRO((disparox[n]-(disparox[n]%16))/16,(disparoy[n]+16-(disparoy[n]%16))/16);
      elidisparo(n);
      }
    if(paisaje[(disparoy[n]+16-(disparoy[n]%16))/16][(disparox[n]+15-((disparox[n]+15)%16))/16]==48)  //detecion de solidos para la esquina derecha inferior
      {
      eliNITRO((disparox[n]+15-((disparox[n]+15)%16))/16,(disparoy[n]+16-(disparoy[n]%16))/16);
      elidisparo(n);
      }
    }
  }
}


void control()  //controla cambios de escenario, monedas, tiempo, conversion de bloques y vuelo.
{
  if(monedas>=1000) //por cada 1000 monedas aumentar una vida
    {
    monedas=0;
    vidas++;
    }
  if(x>=624) //si llega a la orilla derecha pasar a la siguiente escena
    {
    ciclo=1;
    escena++;
    x=2;
    }
  else if(x<=0) //si llega a la orilla izquierda pasar a la anterior escena
    {
    ciclo=1;
    escena--;
    x=622;
    }
  else if(y>=464) //caida
    {
    ciclo=1;
    estado=1;
    vidas--;
    //t_huevo=tiempo-4; //parece no ser necesario
    jugar=0;
    }
  else if(tiempo==0) //tiempo terminado
    {
    estado=0;
    t_huevo=tiempo-4;
    }
  if(t_moneda==tiempo)
    {
    convertir();
    t_moneda=-88;
    }
  if(sec%4==0)  //usado para poder volar cada 4 cuadros
    {
    t_volar=0;
    }
}


void bloques_solidos()  //deteccion de coliciones con bloques solidos. Realiza cambios de posicion y velocidad en el personaje.
{
char e1,e2,e3,e4;
  if(paisaje[(y-(y%16))/16][(x-(x%16))/16]<32)  //detecion de solidos para la esquina izquierda superior
    {
    e1=1;
    }
  else
    {
    e1=0;
    }
  if(paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16]<32)  //detecion de solidos para la esquina derecha superior
    {
    e2=1;
    }
  else
    {
    e2=0;
    }
  if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]<32)  //detecion de solidos para la esquina izquierda inferior
    {
    e3=1;
    }
  else
    {
    e3=0;
    }
  if(paisaje[(y+16-(y%16))/16][(x+15-((x+15)%16))/16]<32)  //detecion de solidos para la esquina derecha inferior
    {
    e4=1;
    }
  else
    {
    e4=0;
    }
//       e1----e2
//        |     |
//        |     |
//       e3----e4
  if(e1==0 && e2==0 && e3==0 && e4==0)
    {
    if(nadando==0)
      {
      vy=vy+0.5;
      }
    else
      {
      vy=vy+0.0625;
      }
    }
  if(e1==1 && e2==0 && e3==1 && e4==0)  //se puede modificar para escalar paredes
    {
    vx=0.0;
    x=x+16-(x%16);
    if(nadando==0)
      {
      vy=vy+0.5;
      }
    else
      {
      vy=vy+0.0625;
      }
    }
  if(e1==0 && e2==0 && e3==1 && e4==1)
    {
    vy=0.0;
    y=y-(y%16);
    }
  if(e1==0 && e2==1 && e3==0 && e4==1)  //se puede modificar para escalar paredes
    {
    vx=0.0;
    x=x-(x%16);
    if(nadando==0)
      {
      vy=vy+0.5;
      }
    else
      {
      vy=vy+0.0625;
      }
    }
  if(e1==1 && e2==1 && e3==0 && e4==0)
    {
    vy=-vy;
    y=y+16-(y%16);
    }
  if(e1==1 && e2==0 && e3==0 && e4==0)
    {
    if(vy<=0)
      {
      if((x%16)<=(y%16))
        {
        vy=-vy;
        y=y+16-(y%16);
        }
      else
        {
        vx=0.0;
        x=x+16-(x%16);
        }
      }
    else
      {
      vx=0.0;
      x=x+16-(x%16);
      }
    }
  if(e1==0 && e2==1 && e3==0 && e4==0)
    {
    if(vy<=0)
      {
      if((x%16)>=(15-(y%16)))
        {
        vy=-vy;
        y=y+16-(y%16);
        }
      else
        {
        vx=0.0;
        x=x-(x%16);
        }
      }
    else
      {
      vx=0.0;
      x=x-(x%16);
      }
    }
  if(e1==0 && e2==0 && e3==1 && e4==0)
    {
    if(vy>=0)
      {
      if((15-(x%16))>=(y%16))
        {
        vy=0.0;
        y=y-(y%16);
        }
      else
        {
        vx=0.0;
        x=x+16-(x%16);
        }
      }
    else
      {
      vx=0.0;
      x=x+16-(x%16);
      }
    }
  if(e1==0 && e2==0 && e3==0 && e4==1)
    {
    if(vy>=0)
      {
      if((x%16)>=(y%16))
        {
        vy=0.0;
        y=y-(y%16);
        }
      else
        {
        vx=0.0;
        x=x-(x%16);
        }
      }
    else
      {
      vx=0.0;
      x=x-(x%16);
      }
    }
  if(e1==1 && e2==1 && e3==1 && e4==0)
    {
    vy=-vy;
    y=y+16-(y%16);
    vx=0.0;
    x=x+16-(x%16);
    }
  if(e1==1 && e2==1 && e3==0 && e4==1)
    {
    vy=-vy;
    y=y+16-(y%16);
    vx=0.0;
    x=x-(x%16);
    }
  if(e1==1 && e2==0 && e3==1 && e4==1)
    {
    vy=0.0;
    y=y-(y%16);
    vx=0.0;
    x=x+16-(x%16);
    }
  if(e1==0 && e2==1 && e3==1 && e4==1)
    {
    vy=0.0;
    y=y-(y%16);
    vx=0.0;
    x=x-(x%16);
    }
  if(e1==1 && e2==0 && e3==0 && e4==1)
    {
    if(vx<0.0)
      {
      y=y-(y%16);
      x=x+16-(x%16);
      }
    else
      {
      y=y+16-(y%16);
      x=x-(x%16);
      }
    vy=0.0;
    vx=0.0;
    }
  if(e1==0 && e2==1 && e3==1 && e4==0)
    {
    if(vx>0.0)
      {
      y=y-(y%16);
      x=x-(x%16);
      }
    else
      {
      y=y+16-(y%16);
      x=x+16-(x%16);
      }
    vy=0.0;
    vx=0.0;
    }
  if(e1==1 && e2==1 && e3==1 && e4==1)
    {
    //si se cumple el personaje esta atorado. no hacer nada
    }
}


void sistema_colisiones()  //detecta colisiones con cualquier tipo de bloques en el escenario. Informa a otras funciones sobre las coliciones
  {
  c1=paisaje[(y-(y%16))/16][(x-(x%16))/16];  //detecion de bloques para la esquina izquierda superior
  c2=paisaje[(y-(y%16))/16][(x+15-((x+15)%16))/16];  //detecion de bloques para la esquina derecha superior
  //c3=paisaje[(y+16-(y%16))/16][(x-(x%16))/16];  //detecion de bloques para la esquina izquierda inferior
  //c4=paisaje[(y+16-(y%16))/16][(x+15-((x+15)%16))/16];  //detecion de bloques para la esquina derecha inferior
  //       c1----c2
  //        |     |
  //        |     |
  //       c3----c4
  }


void teclado()
{
int n;
  if(vx<0)  //disminuir la velocidad
    {
    vx=vx+0.125;  //vx=vx+0.0625;
    }
  else if(vx>0)
    {
    vx=vx-0.125;  //vx=vx-0.0625;
    }
 /* if(vy<0)  //disminuir la velocidad (no se requiere)
    {
    vy=vy+0.125;
    }
  else if(vy>0)
    {
    vy=vy-0.125;
    }*/

  if(tecla[KEY_CUR_ATRAS])  //izquierda 75
    {
    vx=vx-0.5;
    dirx=-1;
    }

  if(tecla[KEY_CUR_ADELANTE])  //derecha 77
    {
    dirx=1;
    if(vx<1 && vx>=0)  //esto no deberia existir pero hay problemas para avanzar a la derecha
      {
      vx=vx+1.0;
      }
    vx=vx+0.5;
    }

  if(tecla[KEY_ESPACIO])  //espacio volar 32
    {
    diry=-1;
    if(volar>0)
      {
      if(t_volar==0)  //determina si el pinguino está listo para aletear otra vez y volar
        {
        t_volar=1;
        volar--;
        vy=-4.0;
        }
      }
    }

  if(tecla[KEY_CUR_ARRIBA])  //saltar 72
    {
    diry=-1;
    if(saltar==1)
      {
      saltar=0;
      if(paisaje[(y+16-(y%16))/16][(x-(x%16))/16]<32 || paisaje[(y+16-(y%16))/16][(x+15-((x+15)%16))/16]<32)  //si existe piso que salte
        {
        if(paisaje[(y-16-(y%16))/16][(x-(x%16))/16]<32 || paisaje[(y-16-(y%16))/16][(x+15-((x+15)%16))/16]<32)  //si existe techo que solo se mueva un poco
          {
          vy=-1.0;
          }
        else
          {
          vy=-8.0;
          }
        }
      }
    }
  else
    {
    saltar=1;
    }

  if(tecla[KEY_CUR_ABAJO])  //undirse en el agua
    {
    diry=1;
    }

  if(tecla[KEY_ENTER])  //enter pausar el juego
    {
#ifdef MSDOS
    pausa();
#endif
    }

  if(tecla[KEY_DELETE])  //suprimir  truco: elimina enemigos
    {
    for(n=0;n<8;n++)
      {
      if(npato[n]!=0)
        {
        elipato(n);
        }
      if(nseguidor[n]!=0)
        {
        eliseguidor(n);
        }
      if(nmina[n]!=0)
        {
        elimina(n);
        }
      if(ntortuga[n]!=0)
        {
        elitortuga(n);
        }
      }
    for(n=0;n<4;n++)
      {
      if(nsalta[n]!=0)
        {
        elisalta(n);
        }
      if(npeligro[n]!=0)
        {
        elipeligro(n);
        }
      }
    }

  if(tecla[KEY_F12])  //F12
    {
    panel_debug_nivel();
    }

  if(tecla[KEY_F4])  //Alt+F4 salir o Escape
    {
    DesinstalaTeclado();
    closegraph();
    exit (2);
    }

  if(tecla[KEY_F1])  //F1 ayuda
    {
    ayuda();
    }

  if(tecla[KEY_ESC])  //esc 27
    {
    //menu();
    }

  if(tecla[KEY_CONTROL])  //tecla control para crear disparo
    {
    if(estado==4)
      {
      c_disparo();
      }
    }

  if(vx>4)  //limite de velocidad
    {
    vx=4;
    }
  if(vy>8)  //limite de velocidad (gravedad)
    {
    vy=8;
    }
  if(vx<-4)  //limite de velocidad
    {
    vx=-4;
    }
  /*if(vy<-4)  //limite de velocidad (no requiere)
    {
    vy=-4;
    }*/
}


main()
{
textmode(64);  //C4350
Patito();
Thierry();
Inicio();
//memoria();

detectargraficos();

if(kbhit())  //si se presiono una tecla para omitir la presentacion, pedir que se presione una vez mas una tecla para iniciar el juego
  {
  getch();
  }

getch();
textcolor(0x0F);
textbackground(0x00);
clrscr();
printf("        Cargando...");
gotoxy(1,1);  //para imprimir archivos faltantes desde la esquina
verificar_existencia();  //revisar que no falten archivos
iniciargraficos();
getpalette(&paleta);
//iniciargraficos256();
//iniciargraficos_color_real();
InstalaTeclado();
#ifdef MSDOS
randomize();
#endif
test_velocidad_paleta();
printf("        Cargando... ­OK!\r\n");

nivel=-3;
escena=20;
escena_presentacion();

while(seguir!=0)
  {
    abrir(0,-88);
    mundo0();
    jugar=1;
  while(jugar!=0)
    {
    switch (nivel)
      {
      case -2:
	switch (escena)
	  {
	  case 0:
	    tutorial0();
	    break;
	  case 1:
	    tutorial1();
	  break;
	  case 2:
	    tutorial2();
	  break;
	  case 3:
	    tutorial3();
	  break;
	  case 20:
	    //escena0_20();
	    jugar=0;
	  break;
	  default:
	    jugar=0;
	  break;
	  }
      break;  //caso nivel=-1 esta reservado para el mundo
      case 0:
	switch (escena)
	  {
	  case 0:
	    escena00();
	    break;
	  case 1:
	    escena01();
	  break;
	  case 2:
	    escena02();
	  break;
	  case 3:
	    escena03();
	  break;
	  case 20:
	    escena0_20();
	  break;
	  default:
	    jugar=0;
	  break;
	  }
      break;
      case 1:
	switch (escena)
	  {
	  case 0:
	    escena10();
	    break;
	  case 1:
	    escena11();
	  break;
	  case 2:
	    escena12();
	  break;
	  case 3:
	    escena13();
	  break;
	  case 20:
	    escena1_20();
	  break;
	  default:
	    jugar=0;
	  break;
	  }
      break;
      case 2:
	switch (escena)
	  {
	  case 0:
	    escena20();
	    break;
	  case 1:
	    escena21();
	  break;
	  case 2:
	    escena22();
	  break;
	  case 3:
	    escena23();
	  break;
	  case 20:
	    escena2_20();
	  break;
	  default:
	  jugar=0;
	  break;
	  }
      break;
      case 3:
	switch (escena)
	  {
	  case 0:
	    escena30();
	  break;
	  case 1:
	    escena31();
	  break;
	  case 2:
	    escena32();
	  break;
	  case 3:
	    escena33();
	  break;
	  case 20:
	    escena3_20();
	  break;
	  default:
	    jugar=0;
	  break;
	  }
      break;
      case 4:
	switch (escena)
	  {
	  case 0:
	    escena40();
	  break;
	  case 1:
	    escena41();
	  break;
	  case 2:
	    escena42();
	  break;
	  case 3:
	    escena43();
	  break;
	  case 20:
	    //escena4_20();
	    jugar=0;
	  break;
	  default:
	    jugar=0;
	  break;
	  }
      break;
      case 5:
	switch (escena)
	  {
	  case 0:
            escena50();
          break;
          case 1:
            escena51();
          break;
          case 2:
            escena52();
          break;
          case 3:
            escena53();
          break;
          case 20:
            //escena5_20();
            jugar=0;
          break;
          default:
            jugar=0;
          break;
          }
      break;
      case 6:
        switch (escena)
          {
          case 0:
            escena60();
          break;
          case 1:
            escena61();
          break;
          case 2:
            escena62();
          break;
          case 3:
            escena63();
          break;
          case 20:
            //escena6_20();
            jugar=0;
          break;
          default:
            jugar=0;
          break;
          }
      break;
      case 7:
        switch (escena)
          {
          case 0:
            escena70();
          break;
          case 1:
            escena71();
          break;
          case 2:
            escena72();
          break;
          case 3:
            escena73();
          break;
          case 20:
            //escena7_20();
            jugar=0;
          break;
          default:
            jugar=0;
          break;
          }
      break;
      case 8:
        switch (escena)
          {
          case 0:
            escena80();
          break;
          case 1:
            escena81();
          break;
          case 2:
            escena82();
          break;
          case 3:
            escena83();
          break;
          case 20:
            //escena8_20();
            jugar=0;
          break;
          default:
            jugar=0;
          break;
          }
      break;
      case 9:
        switch (escena)
          {
          case 0:
            escena90();
          break;
          case 1:
            escena91();
          break;
          case 2:
            escena92();
          break;
          case 3:
            escena93();
          break;
          case 20:
            //escena9_20();
            jugar=0;
          break;
          default:
            jugar=0;
          break;
          }
      break;
      default:
      break;
      }
    }
  }
DesinstalaTeclado();
closegraph();
return(0);
}
